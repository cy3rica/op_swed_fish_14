-- These queries set up data for end-of-year student performance data reporting.
-- HAVEN'T TESTED THIS YET.

-- QUERY SYNTAX (BASED ON MATH CG/ASSESS QUERIES -- STEP 1):

SELECT prepost_MTH.SITE_NAME, prepost_MTH.SCHOOL_NAME, prepost_MTH.GRADE_ID, prepost_MTH.DIPLOMAS_NOW_SCHOOL, prepost_MTH.STUDENT_ID, prepost_MTH.SCHOOL_ID, prepost_MTH.ASSESSMENT_TYPE, prepost_MTH.PRE_VALUE, prepost_MTH.PRE_VALUE_DISPLAY, prepost_MTH.PRE_VALUE_NUM, prepost_MTH.PRE_DATE, prepost_MTH.PRE_DESC, prepost_MTH.PRE_TRACK, prepost_MTH.PRE_TRACK_EVAL, prepost_MTH.PRE_TRACK_NATIONAL, prepost_MTH.POST_VALUE, prepost_MTH.POST_VALUE_DISPLAY, prepost_MTH.POST_VALUE_NUM, prepost_MTH.POST_DATE, prepost_MTH.POST_DESC, prepost_MTH.POST_TRACK, prepost_MTH.POST_TRACK_EVAL, prepost_MTH.POST_TRACK_NATIONAL, prepost_MTH.DOSAGE_CATEGORY, prepost_MTH.TTL_TIME, prepost_MTH.ENROLLED_DAYS_CATEGORIES, prepost_MTH.CURRENTLY_ENROLLED, prepost_MTH.ENROLLED_DAYS, prepost_MTH.LIT_ASSESS_RAWCHANGE, prepost_MTH.LIT_ASSESS_RAWCHANGE_DEGREE, prepost_MTH.LIT_ASSESS_PERFORMANCECHANGE_LOCAL, prepost_MTH.LIT_ASSESS_PERFORMANCECHANGE_NORMALIZED, prepost_MTH.LIT_ASSESS_PERCENTCHANGE, prepost_MTH.STATUS_SITE_DOSAGE_GOAL, prepost_MTH.SITE_DOSAGE_GOAL, prepost_MTH.Attendance_IA, prepost_MTH.ELA_IA, prepost_MTH.Math_IA, prepost_MTH.Behavior_IA, prepost_MTH.INDICATOR_ID, prepost_MTH.B_RULE_VAL1, prepost_MTH.B_RULE_VAL2, prepost_MTH.B_RULE_VAL3, prepost_MTH.B_RULE_VAL4, prepost_MTH.B_RULE_VAL5, prepost_MTH.GRADE_ID_RECODE, prepost_MTH.EOY_MET_Q3_DOSAGE, prepost_MTH.DN_SCHOOL_BY_GRADE, prepost_MTH.EOY_IN_IOG_GRADE_RANGE, prepost_MTHCG.PRE_MATH_CG_VALUE, prepost_MTHCG.PRE_MATH_CG_VALUE_DISPLAY, prepost_MTHCG.PRE_MATH_CG_VALUE_NUM, prepost_MTHCG.PRE_MATH_DESC, prepost_MTHCG.PRE_MATH_FREQ, prepost_MTHCG.PRE_MATH_TRACK, prepost_MTHCG.PRE_MATH_TRACK_EVAL, prepost_MTHCG.PRE_SCENARIO, prepost_MTHCG.PRE_LETTER_VIEW, prepost_MTHCG.PRE_CG_LETTER_SCALE_ALL, prepost_MTHCG.POST_MATH_CG_VALUE, prepost_MTHCG.POST_MATH_CG_VALUE_DISPLAY, prepost_MTHCG.POST_MATH_CG_VALUE_NUM, prepost_MTHCG.POST_MATH_DESC, prepost_MTHCG.POST_MATH_FREQ, prepost_MTHCG.POST_MATH_TRACK, prepost_MTHCG.POST_MATH_TRACK_EVAL, prepost_MTHCG.POST_SCENARIO, prepost_MTHCG.POST_LETTER_VIEW, prepost_MTHCG.POST_CG_LETTER_SCALE_ALL, prepost_MTHCG.LETTERGADE_CHANGE_ACTUAL, prepost_MTHCG.LETTERGADE_CHANGE_GENERAL, prepost_MTHCG.CG_Performance_Level_Change, prepost_MTHCG.CG_Change, prepost_MTHCG.Enrollment_Duration, prepost_MTHCG.ENROLL_DAYS,
CASE WHEN (prepost_MTH.PRE_TRACK_EVAL LIKE 'OFF TRACK' OR prepost_MTH.PRE_TRACK_EVAL LIKE 'SLIDING') AND (prepost_MTHCG.PRE_MATH_TRACK LIKE 'OFF TRACK' OR prepost_MTHCG.PRE_MATH_TRACK LIKE 'SLIDING') THEN 'Off-Track/Sliding in Assessments, Off-Track/Sliding in Math CG' WHEN (prepost_MTH.PRE_TRACK_EVAL LIKE 'OFF TRACK' OR prepost_MTH.PRE_TRACK_EVAL LIKE 'SLIDING') AND (prepost_MTHCG.PRE_MATH_TRACK LIKE 'ON TRACK') THEN 'Off-Track/Sliding in Assessments, On-Track in Math CG' WHEN (prepost_MTH.PRE_TRACK_EVAL LIKE 'ON TRACK') AND (prepost_MTHCG.PRE_MATH_TRACK LIKE 'OFF TRACK' OR prepost_MTHCG.PRE_MATH_TRACK LIKE 'SLIDING') THEN 'On-Track in Assessments, Off-Track/Sliding in Math CG' WHEN (prepost_MTH.PRE_TRACK_EVAL LIKE 'ON TRACK') AND (prepost_MTHCG.PRE_MATH_TRACK LIKE 'ON TRACK') THEN 'On-Track in Assessments, On-Track in Math CG' ELSE NULL END AS EOY_MTHA_MTHCG_PRE_COMPARE,
CASE WHEN (prepost_MTH.PRE_TRACK_EVAL LIKE 'OFF TRACK' OR prepost_MTH.PRE_TRACK_EVAL LIKE 'SLIDING') AND (prepost_MTHCG.PRE_MATH_TRACK LIKE 'OFF TRACK' OR prepost_MTHCG.PRE_MATH_TRACK LIKE 'SLIDING') THEN 4 WHEN (prepost_MTH.PRE_TRACK_EVAL LIKE 'OFF TRACK' OR prepost_MTH.PRE_TRACK_EVAL LIKE 'SLIDING') AND (prepost_MTHCG.PRE_MATH_TRACK LIKE 'ON TRACK') THEN 3 WHEN (prepost_MTH.PRE_TRACK_EVAL LIKE 'ON TRACK') AND (prepost_MTHCG.PRE_MATH_TRACK LIKE 'OFF TRACK' OR prepost_MTHCG.PRE_MATH_TRACK LIKE 'SLIDING') THEN 2 WHEN (prepost_MTH.PRE_TRACK_EVAL LIKE 'ON TRACK') AND (prepost_MTHCG.PRE_MATH_TRACK LIKE 'ON TRACK') THEN 1 ELSE NULL END AS EOY_MTHA_MTHCG_PRE_COMPARE_NUM,
CASE WHEN (prepost_MTH.POST_TRACK_EVAL LIKE 'OFF TRACK' OR prepost_MTH.POST_TRACK_EVAL LIKE 'SLIDING') AND (prepost_MTHCG.POST_MATH_TRACK LIKE 'OFF TRACK' OR prepost_MTHCG.POST_MATH_TRACK LIKE 'SLIDING') THEN 'Off-Track/Sliding in Assessments, Off-Track/Sliding in Math CG' WHEN (prepost_MTH.POST_TRACK_EVAL LIKE 'OFF TRACK' OR prepost_MTH.POST_TRACK_EVAL LIKE 'SLIDING') AND (prepost_MTHCG.POST_MATH_TRACK LIKE 'ON TRACK') THEN 'Off-Track/Sliding in Assessments, On-Track in Math CG' WHEN (prepost_MTH.POST_TRACK_EVAL LIKE 'ON TRACK') AND (prepost_MTHCG.POST_MATH_TRACK LIKE 'OFF TRACK' OR prepost_MTHCG.POST_MATH_TRACK LIKE 'SLIDING') THEN 'On-Track in Assessments, Off-Track/Sliding in Math CG' WHEN (prepost_MTH.POST_TRACK_EVAL LIKE 'ON TRACK') AND (prepost_MTHCG.POST_MATH_TRACK LIKE 'ON TRACK') THEN 'On-Track in Assessments, On-Track in Math CG' ELSE NULL END AS EOY_MTHA_MTHCG_POST_COMPARE,
CASE WHEN (prepost_MTH.POST_TRACK_EVAL LIKE 'OFF TRACK' OR prepost_MTH.POST_TRACK_EVAL LIKE 'SLIDING') AND (prepost_MTHCG.POST_MATH_TRACK LIKE 'OFF TRACK' OR prepost_MTHCG.POST_MATH_TRACK LIKE 'SLIDING') THEN 4 WHEN (prepost_MTH.POST_TRACK_EVAL LIKE 'OFF TRACK' OR prepost_MTH.POST_TRACK_EVAL LIKE 'SLIDING') AND (prepost_MTHCG.POST_MATH_TRACK LIKE 'ON TRACK') THEN 3 WHEN (prepost_MTH.POST_TRACK_EVAL LIKE 'ON TRACK') AND (prepost_MTHCG.POST_MATH_TRACK LIKE 'OFF TRACK' OR prepost_MTHCG.POST_MATH_TRACK LIKE 'SLIDING') THEN 2 WHEN (prepost_MTH.POST_TRACK_EVAL LIKE 'ON TRACK') AND (prepost_MTHCG.POST_MATH_TRACK LIKE 'ON TRACK') THEN 1 ELSE NULL END AS EOY_MTHA_MTHCG_POST_COMPARE_NUM
FROM
(*****MTH ASSESS QUERY*****)
AS prepost_MTH INNER JOIN
(*****MTH CG QUERY*****)
AS prepost_MTHCG
ON prepost_MTH.STUDENT_ID = prepost_MTHCG.STUDENT_ID;

-- QUERY SYNTAX (BASED ON ABOVE QUERY -- STEP 2 -- this extra step is required since calculations/joins on new variables can't reference variables that were just created in the same query):

DROP TABLE ImpactAnalytics.dbo.FY14_EOY_MTH_ASSESS_MTH_CG
SELECT PPPFINAL.*,
CASE WHEN EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in Math CG' AND EOY_MTHA_MTHCG_POST_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in Math CG' THEN 'Remained Off-Track/Sliding in Assessments and Math CG' WHEN EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in Math CG' AND EOY_MTHA_MTHCG_POST_COMPARE LIKE 'On-Track in Assessments, On-Track in Math CG' THEN 'Moved On-Track in Both Assessments and Math CG' WHEN EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in Math CG' AND EOY_MTHA_MTHCG_POST_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in Math CG' THEN 'Remained Off-Track/Sliding in Assessments, Moved On-Track in Math CG' WHEN EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in Math CG' AND EOY_MTHA_MTHCG_POST_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in Math CG' THEN 'Moved On-Track in Assessments, Remained Off-Track/Sliding in Math CG' ELSE NULL END AS EOY_MTHAOFF_MTHCGOFF_CHANGE,
CASE WHEN EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in Math CG' AND EOY_MTHA_MTHCG_POST_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in Math CG' THEN 4 WHEN EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in Math CG' AND EOY_MTHA_MTHCG_POST_COMPARE LIKE 'On-Track in Assessments, On-Track in Math CG' THEN 1 WHEN EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in Math CG' AND EOY_MTHA_MTHCG_POST_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in Math CG' THEN 3 WHEN EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in Math CG' AND EOY_MTHA_MTHCG_POST_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in Math CG' THEN 2 ELSE NULL END AS EOY_MTHAOFF_MTHCGOFF_CHANGE_NUM,
CASE WHEN EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'On-Track in Assessments, On-Track in Math CG' AND EOY_MTHA_MTHCG_POST_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in Math CG' THEN 'Moved Off-Track/Sliding in Both Assessments and Math CG' WHEN EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'On-Track in Assessments, On-Track in Math CG' AND EOY_MTHA_MTHCG_POST_COMPARE LIKE 'On-Track in Assessments, On-Track in Math CG' THEN 'Remained On-Track in Assessments and Math CG' WHEN EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'On-Track in Assessments, On-Track in Math CG' AND EOY_MTHA_MTHCG_POST_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in Math CG' THEN 'Moved Off-Track/Sliding in Assessments, Remained On-Track in Math CG' WHEN EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'On-Track in Assessments, On-Track in Math CG' AND EOY_MTHA_MTHCG_POST_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in Math CG' THEN 'Remained On-Track in Assessments, Moved Off-Track/Sliding in Math CG' ELSE NULL END AS EOY_MTHAON_MTHCGON_CHANGE,
CASE WHEN EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'On-Track in Assessments, On-Track in Math CG' AND EOY_MTHA_MTHCG_POST_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in Math CG' THEN 4 WHEN EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'On-Track in Assessments, On-Track in Math CG' AND EOY_MTHA_MTHCG_POST_COMPARE LIKE 'On-Track in Assessments, On-Track in Math CG' THEN 1 WHEN EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'On-Track in Assessments, On-Track in Math CG' AND EOY_MTHA_MTHCG_POST_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in Math CG' THEN 3 WHEN EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'On-Track in Assessments, On-Track in Math CG' AND EOY_MTHA_MTHCG_POST_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in Math CG' THEN 2 ELSE NULL END AS EOY_MTHAON_MTHCGON_CHANGE_NUM,
CASE WHEN EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in Math CG' AND EOY_MTHA_MTHCG_POST_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in Math CG' THEN 'Remained Off-Track/Sliding in Assessments, Moved Off-Track/Sliding in Math CG' WHEN EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in Math CG' AND EOY_MTHA_MTHCG_POST_COMPARE LIKE 'On-Track in Assessments, On-Track in Math CG' THEN 'Moved On-Track in Assessments and Remained On-Track in Math CG' WHEN EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in Math CG' AND EOY_MTHA_MTHCG_POST_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in Math CG' THEN 'Remained Off-Track/Sliding in Assessments, Remained On-Track in Math CG' WHEN EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in Math CG' AND EOY_MTHA_MTHCG_POST_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in Math CG' THEN 'Moved On-Track in Assessments, Moved Off-Track/Sliding in Math CG' ELSE NULL END AS EOY_MTHAOFF_MTHCGON_CHANGE,
CASE WHEN EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in Math CG' AND EOY_MTHA_MTHCG_POST_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in Math CG' THEN 4 WHEN EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in Math CG' AND EOY_MTHA_MTHCG_POST_COMPARE LIKE 'On-Track in Assessments, On-Track in Math CG' THEN 1 WHEN EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in Math CG' AND EOY_MTHA_MTHCG_POST_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in Math CG' THEN 3 WHEN EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in Math CG' AND EOY_MTHA_MTHCG_POST_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in Math CG' THEN 2 ELSE NULL END AS EOY_MTHAOFF_MTHCGON_CHANGE_NUM,
CASE WHEN EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in Math CG' AND EOY_MTHA_MTHCG_POST_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in Math CG' THEN 'Moved Off-Track/Sliding in Assessments, Remained Off-Track/Sliding in Math CG' WHEN EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in Math CG' AND EOY_MTHA_MTHCG_POST_COMPARE LIKE 'On-Track in Assessments, On-Track in Math CG' THEN 'Remained On-Track in Assessments, Moved On-Track in Math CG' WHEN EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in Math CG' AND EOY_MTHA_MTHCG_POST_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in Math CG' THEN 'Moved Off-Track/Sliding in Assessments, Moved On-Track in Math CG' WHEN EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in Math CG' AND EOY_MTHA_MTHCG_POST_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in Math CG' THEN 'Remained On-Track in Assessments, Remained Off-Track/Sliding in Math CG' ELSE NULL END AS EOY_MTHAON_MTHCGOFF_CHANGE,
CASE WHEN EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in Math CG' AND EOY_MTHA_MTHCG_POST_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in Math CG' THEN 4 WHEN EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in Math CG' AND EOY_MTHA_MTHCG_POST_COMPARE LIKE 'On-Track in Assessments, On-Track in Math CG' THEN 1 WHEN EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in Math CG' AND EOY_MTHA_MTHCG_POST_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in Math CG' THEN 3 WHEN EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in Math CG' AND EOY_MTHA_MTHCG_POST_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in Math CG' THEN 2 ELSE NULL END AS EOY_MTHAON_MTHCGOFF_CHANGE_NUM
INTO ImpactAnalytics.dbo.FY14_EOY_MTH_ASSESS_MTH_CG
FROM
(*****ABOVE_QUERY*****)
AS PPPFINAL
ORDER BY SITE_NAME, SCHOOL_NAME, GRADE_ID, STUDENT_ID;

-- QUERY SYNTAX (SINGLE QUERY VERSION):

DROP TABLE ImpactAnalytics.dbo.FY14_EOY_MTH_ASSESS_MTH_CG
SELECT PPPFINAL.*,
CASE WHEN EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in Math CG' AND EOY_MTHA_MTHCG_POST_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in Math CG' THEN 'Remained Off-Track/Sliding in Assessments and Math CG' WHEN EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in Math CG' AND EOY_MTHA_MTHCG_POST_COMPARE LIKE 'On-Track in Assessments, On-Track in Math CG' THEN 'Moved On-Track in Both Assessments and Math CG' WHEN EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in Math CG' AND EOY_MTHA_MTHCG_POST_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in Math CG' THEN 'Remained Off-Track/Sliding in Assessments, Moved On-Track in Math CG' WHEN EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in Math CG' AND EOY_MTHA_MTHCG_POST_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in Math CG' THEN 'Moved On-Track in Assessments, Remained Off-Track/Sliding in Math CG' ELSE NULL END AS EOY_MTHAOFF_MTHCGOFF_CHANGE,
CASE WHEN EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in Math CG' AND EOY_MTHA_MTHCG_POST_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in Math CG' THEN 4 WHEN EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in Math CG' AND EOY_MTHA_MTHCG_POST_COMPARE LIKE 'On-Track in Assessments, On-Track in Math CG' THEN 1 WHEN EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in Math CG' AND EOY_MTHA_MTHCG_POST_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in Math CG' THEN 3 WHEN EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in Math CG' AND EOY_MTHA_MTHCG_POST_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in Math CG' THEN 2 ELSE NULL END AS EOY_MTHAOFF_MTHCGOFF_CHANGE_NUM,
CASE WHEN EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'On-Track in Assessments, On-Track in Math CG' AND EOY_MTHA_MTHCG_POST_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in Math CG' THEN 'Moved Off-Track/Sliding in Both Assessments and Math CG' WHEN EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'On-Track in Assessments, On-Track in Math CG' AND EOY_MTHA_MTHCG_POST_COMPARE LIKE 'On-Track in Assessments, On-Track in Math CG' THEN 'Remained On-Track in Assessments and Math CG' WHEN EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'On-Track in Assessments, On-Track in Math CG' AND EOY_MTHA_MTHCG_POST_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in Math CG' THEN 'Moved Off-Track/Sliding in Assessments, Remained On-Track in Math CG' WHEN EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'On-Track in Assessments, On-Track in Math CG' AND EOY_MTHA_MTHCG_POST_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in Math CG' THEN 'Remained On-Track in Assessments, Moved Off-Track/Sliding in Math CG' ELSE NULL END AS EOY_MTHAON_MTHCGON_CHANGE,
CASE WHEN EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'On-Track in Assessments, On-Track in Math CG' AND EOY_MTHA_MTHCG_POST_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in Math CG' THEN 4 WHEN EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'On-Track in Assessments, On-Track in Math CG' AND EOY_MTHA_MTHCG_POST_COMPARE LIKE 'On-Track in Assessments, On-Track in Math CG' THEN 1 WHEN EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'On-Track in Assessments, On-Track in Math CG' AND EOY_MTHA_MTHCG_POST_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in Math CG' THEN 3 WHEN EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'On-Track in Assessments, On-Track in Math CG' AND EOY_MTHA_MTHCG_POST_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in Math CG' THEN 2 ELSE NULL END AS EOY_MTHAON_MTHCGON_CHANGE_NUM,
CASE WHEN EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in Math CG' AND EOY_MTHA_MTHCG_POST_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in Math CG' THEN 'Remained Off-Track/Sliding in Assessments, Moved Off-Track/Sliding in Math CG' WHEN EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in Math CG' AND EOY_MTHA_MTHCG_POST_COMPARE LIKE 'On-Track in Assessments, On-Track in Math CG' THEN 'Moved On-Track in Assessments and Remained On-Track in Math CG' WHEN EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in Math CG' AND EOY_MTHA_MTHCG_POST_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in Math CG' THEN 'Remained Off-Track/Sliding in Assessments, Remained On-Track in Math CG' WHEN EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in Math CG' AND EOY_MTHA_MTHCG_POST_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in Math CG' THEN 'Moved On-Track in Assessments, Moved Off-Track/Sliding in Math CG' ELSE NULL END AS EOY_MTHAOFF_MTHCGON_CHANGE,
CASE WHEN EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in Math CG' AND EOY_MTHA_MTHCG_POST_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in Math CG' THEN 4 WHEN EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in Math CG' AND EOY_MTHA_MTHCG_POST_COMPARE LIKE 'On-Track in Assessments, On-Track in Math CG' THEN 1 WHEN EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in Math CG' AND EOY_MTHA_MTHCG_POST_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in Math CG' THEN 3 WHEN EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in Math CG' AND EOY_MTHA_MTHCG_POST_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in Math CG' THEN 2 ELSE NULL END AS EOY_MTHAOFF_MTHCGON_CHANGE_NUM,
CASE WHEN EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in Math CG' AND EOY_MTHA_MTHCG_POST_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in Math CG' THEN 'Moved Off-Track/Sliding in Assessments, Remained Off-Track/Sliding in Math CG' WHEN EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in Math CG' AND EOY_MTHA_MTHCG_POST_COMPARE LIKE 'On-Track in Assessments, On-Track in Math CG' THEN 'Remained On-Track in Assessments, Moved On-Track in Math CG' WHEN EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in Math CG' AND EOY_MTHA_MTHCG_POST_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in Math CG' THEN 'Moved Off-Track/Sliding in Assessments, Moved On-Track in Math CG' WHEN EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in Math CG' AND EOY_MTHA_MTHCG_POST_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in Math CG' THEN 'Remained On-Track in Assessments, Remained Off-Track/Sliding in Math CG' ELSE NULL END AS EOY_MTHAON_MTHCGOFF_CHANGE,
CASE WHEN EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in Math CG' AND EOY_MTHA_MTHCG_POST_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in Math CG' THEN 4 WHEN EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in Math CG' AND EOY_MTHA_MTHCG_POST_COMPARE LIKE 'On-Track in Assessments, On-Track in Math CG' THEN 1 WHEN EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in Math CG' AND EOY_MTHA_MTHCG_POST_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in Math CG' THEN 3 WHEN EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in Math CG' AND EOY_MTHA_MTHCG_POST_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in Math CG' THEN 2 ELSE NULL END AS EOY_MTHAON_MTHCGOFF_CHANGE_NUM
INTO ImpactAnalytics.dbo.FY14_EOY_MTH_ASSESS_MTH_CG
FROM
(SELECT prepost_MTH.SITE_NAME, prepost_MTH.SCHOOL_NAME, prepost_MTH.GRADE_ID, prepost_MTH.DIPLOMAS_NOW_SCHOOL, prepost_MTH.STUDENT_ID, prepost_MTH.SCHOOL_ID, prepost_MTH.ASSESSMENT_TYPE, prepost_MTH.PRE_VALUE, prepost_MTH.PRE_VALUE_DISPLAY, prepost_MTH.PRE_VALUE_NUM, prepost_MTH.PRE_DATE, prepost_MTH.PRE_DESC, prepost_MTH.PRE_TRACK, prepost_MTH.PRE_TRACK_EVAL, prepost_MTH.PRE_TRACK_NATIONAL, prepost_MTH.POST_VALUE, prepost_MTH.POST_VALUE_DISPLAY, prepost_MTH.POST_VALUE_NUM, prepost_MTH.POST_DATE, prepost_MTH.POST_DESC, prepost_MTH.POST_TRACK, prepost_MTH.POST_TRACK_EVAL, prepost_MTH.POST_TRACK_NATIONAL, prepost_MTH.DOSAGE_CATEGORY, prepost_MTH.TTL_TIME, prepost_MTH.ENROLLED_DAYS_CATEGORIES, prepost_MTH.CURRENTLY_ENROLLED, prepost_MTH.ENROLLED_DAYS, prepost_MTH.LIT_ASSESS_RAWCHANGE, prepost_MTH.LIT_ASSESS_RAWCHANGE_DEGREE, prepost_MTH.LIT_ASSESS_PERFORMANCECHANGE_LOCAL, prepost_MTH.LIT_ASSESS_PERFORMANCECHANGE_NORMALIZED, prepost_MTH.LIT_ASSESS_PERCENTCHANGE, prepost_MTH.STATUS_SITE_DOSAGE_GOAL, prepost_MTH.SITE_DOSAGE_GOAL, prepost_MTH.Attendance_IA, prepost_MTH.ELA_IA, prepost_MTH.Math_IA, prepost_MTH.Behavior_IA, prepost_MTH.INDICATOR_ID, prepost_MTH.B_RULE_VAL1, prepost_MTH.B_RULE_VAL2, prepost_MTH.B_RULE_VAL3, prepost_MTH.B_RULE_VAL4, prepost_MTH.B_RULE_VAL5, prepost_MTH.GRADE_ID_RECODE, prepost_MTH.EOY_MET_Q3_DOSAGE, prepost_MTH.DN_SCHOOL_BY_GRADE, prepost_MTH.EOY_IN_IOG_GRADE_RANGE, prepost_MTHCG.PRE_MATH_CG_VALUE, prepost_MTHCG.PRE_MATH_CG_VALUE_DISPLAY, prepost_MTHCG.PRE_MATH_CG_VALUE_NUM, prepost_MTHCG.PRE_MATH_DESC, prepost_MTHCG.PRE_MATH_FREQ, prepost_MTHCG.PRE_MATH_TRACK, prepost_MTHCG.PRE_MATH_TRACK_EVAL, prepost_MTHCG.PRE_SCENARIO, prepost_MTHCG.PRE_LETTER_VIEW, prepost_MTHCG.PRE_CG_LETTER_SCALE_ALL, prepost_MTHCG.POST_MATH_CG_VALUE, prepost_MTHCG.POST_MATH_CG_VALUE_DISPLAY, prepost_MTHCG.POST_MATH_CG_VALUE_NUM, prepost_MTHCG.POST_MATH_DESC, prepost_MTHCG.POST_MATH_FREQ, prepost_MTHCG.POST_MATH_TRACK, prepost_MTHCG.POST_MATH_TRACK_EVAL, prepost_MTHCG.POST_SCENARIO, prepost_MTHCG.POST_LETTER_VIEW, prepost_MTHCG.POST_CG_LETTER_SCALE_ALL, prepost_MTHCG.LETTERGADE_CHANGE_ACTUAL, prepost_MTHCG.LETTERGADE_CHANGE_GENERAL, prepost_MTHCG.CG_Performance_Level_Change, prepost_MTHCG.CG_Change, prepost_MTHCG.Enrollment_Duration, prepost_MTHCG.ENROLL_DAYS,
CASE WHEN (prepost_MTH.PRE_TRACK_EVAL LIKE 'OFF TRACK' OR prepost_MTH.PRE_TRACK_EVAL LIKE 'SLIDING') AND (prepost_MTHCG.PRE_MATH_TRACK LIKE 'OFF TRACK' OR prepost_MTHCG.PRE_MATH_TRACK LIKE 'SLIDING') THEN 'Off-Track/Sliding in Assessments, Off-Track/Sliding in Math CG' WHEN (prepost_MTH.PRE_TRACK_EVAL LIKE 'OFF TRACK' OR prepost_MTH.PRE_TRACK_EVAL LIKE 'SLIDING') AND (prepost_MTHCG.PRE_MATH_TRACK LIKE 'ON TRACK') THEN 'Off-Track/Sliding in Assessments, On-Track in Math CG' WHEN (prepost_MTH.PRE_TRACK_EVAL LIKE 'ON TRACK') AND (prepost_MTHCG.PRE_MATH_TRACK LIKE 'OFF TRACK' OR prepost_MTHCG.PRE_MATH_TRACK LIKE 'SLIDING') THEN 'On-Track in Assessments, Off-Track/Sliding in Math CG' WHEN (prepost_MTH.PRE_TRACK_EVAL LIKE 'ON TRACK') AND (prepost_MTHCG.PRE_MATH_TRACK LIKE 'ON TRACK') THEN 'On-Track in Assessments, On-Track in Math CG' ELSE NULL END AS EOY_MTHA_MTHCG_PRE_COMPARE,
CASE WHEN (prepost_MTH.PRE_TRACK_EVAL LIKE 'OFF TRACK' OR prepost_MTH.PRE_TRACK_EVAL LIKE 'SLIDING') AND (prepost_MTHCG.PRE_MATH_TRACK LIKE 'OFF TRACK' OR prepost_MTHCG.PRE_MATH_TRACK LIKE 'SLIDING') THEN 4 WHEN (prepost_MTH.PRE_TRACK_EVAL LIKE 'OFF TRACK' OR prepost_MTH.PRE_TRACK_EVAL LIKE 'SLIDING') AND (prepost_MTHCG.PRE_MATH_TRACK LIKE 'ON TRACK') THEN 3 WHEN (prepost_MTH.PRE_TRACK_EVAL LIKE 'ON TRACK') AND (prepost_MTHCG.PRE_MATH_TRACK LIKE 'OFF TRACK' OR prepost_MTHCG.PRE_MATH_TRACK LIKE 'SLIDING') THEN 2 WHEN (prepost_MTH.PRE_TRACK_EVAL LIKE 'ON TRACK') AND (prepost_MTHCG.PRE_MATH_TRACK LIKE 'ON TRACK') THEN 1 ELSE NULL END AS EOY_MTHA_MTHCG_PRE_COMPARE_NUM,
CASE WHEN (prepost_MTH.POST_TRACK_EVAL LIKE 'OFF TRACK' OR prepost_MTH.POST_TRACK_EVAL LIKE 'SLIDING') AND (prepost_MTHCG.POST_MATH_TRACK LIKE 'OFF TRACK' OR prepost_MTHCG.POST_MATH_TRACK LIKE 'SLIDING') THEN 'Off-Track/Sliding in Assessments, Off-Track/Sliding in Math CG' WHEN (prepost_MTH.POST_TRACK_EVAL LIKE 'OFF TRACK' OR prepost_MTH.POST_TRACK_EVAL LIKE 'SLIDING') AND (prepost_MTHCG.POST_MATH_TRACK LIKE 'ON TRACK') THEN 'Off-Track/Sliding in Assessments, On-Track in Math CG' WHEN (prepost_MTH.POST_TRACK_EVAL LIKE 'ON TRACK') AND (prepost_MTHCG.POST_MATH_TRACK LIKE 'OFF TRACK' OR prepost_MTHCG.POST_MATH_TRACK LIKE 'SLIDING') THEN 'On-Track in Assessments, Off-Track/Sliding in Math CG' WHEN (prepost_MTH.POST_TRACK_EVAL LIKE 'ON TRACK') AND (prepost_MTHCG.POST_MATH_TRACK LIKE 'ON TRACK') THEN 'On-Track in Assessments, On-Track in Math CG' ELSE NULL END AS EOY_MTHA_MTHCG_POST_COMPARE,
CASE WHEN (prepost_MTH.POST_TRACK_EVAL LIKE 'OFF TRACK' OR prepost_MTH.POST_TRACK_EVAL LIKE 'SLIDING') AND (prepost_MTHCG.POST_MATH_TRACK LIKE 'OFF TRACK' OR prepost_MTHCG.POST_MATH_TRACK LIKE 'SLIDING') THEN 4 WHEN (prepost_MTH.POST_TRACK_EVAL LIKE 'OFF TRACK' OR prepost_MTH.POST_TRACK_EVAL LIKE 'SLIDING') AND (prepost_MTHCG.POST_MATH_TRACK LIKE 'ON TRACK') THEN 3 WHEN (prepost_MTH.POST_TRACK_EVAL LIKE 'ON TRACK') AND (prepost_MTHCG.POST_MATH_TRACK LIKE 'OFF TRACK' OR prepost_MTHCG.POST_MATH_TRACK LIKE 'SLIDING') THEN 2 WHEN (prepost_MTH.POST_TRACK_EVAL LIKE 'ON TRACK') AND (prepost_MTHCG.POST_MATH_TRACK LIKE 'ON TRACK') THEN 1 ELSE NULL END AS EOY_MTHA_MTHCG_POST_COMPARE_NUM
FROM
ImpactAnalytics.dbo.FY14_EOY_MTH_ASSESS
AS prepost_MTH INNER JOIN
ImpactAnalytics.dbo.FY14_EOY_MTH_CG
AS prepost_MTHCG
ON prepost_MTH.STUDENT_ID = prepost_MTHCG.STUDENT_ID)
AS PPPFINAL
ORDER BY SITE_NAME, SCHOOL_NAME, GRADE_ID, STUDENT_ID;