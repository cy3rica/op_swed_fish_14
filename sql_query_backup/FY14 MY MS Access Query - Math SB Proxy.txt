-- Step 1.1 and 1.2: Restructure all math standards based data (non-tagged), then select latest administration.
-- Step 2.1 and 2.2: Restructure all math standards based data (tagged), keeping only scale_local variables. Need one version for pre-tags and one for post-tags.
-- Step 3: First, merge scale_local variables to original table dbo_EVAL_SB_ELA.
-- Step 4: Then, merge proxy data points to table created in step 3. Need to do this after last merge, because we'll need those scale_local variables available for creating new variables at this current step.

-- (Step 1.1) QUERY SYNTAX (Restructure data file - non-tagged):

SELECT MTH_SB.STUDENT_ID, MTH_SB.INTERVAL,
AVG(MTH_SB.FREQUENCY_PERIOD_ID) AS PROXY_FREQUENCY_PERIOD_ID,
AVG(IIf(MTH_SB.SKILL_DESCRIPTION LIKE 'Arithmetic with Polynomials and Rational Expressions',MTH_SB.PERFORMANCE_VALUE_NUMERIC,NULL)) AS PROXY_ART_POL_RAT_EXP,
MAX(IIf(MTH_SB.SKILL_DESCRIPTION LIKE 'Arithmetic with Polynomials and Rational Expressions',MTH_SB.SCALE_LOCAL,NULL)) AS PROXY_ART_POL_RAT_EXP_LVL,
AVG(IIf(MTH_SB.SKILL_DESCRIPTION LIKE 'Creating Equations',MTH_SB.PERFORMANCE_VALUE_NUMERIC,NULL)) AS PROXY_CRE_EQU,
MAX(IIf(MTH_SB.SKILL_DESCRIPTION LIKE 'Creating Equations',MTH_SB.SCALE_LOCAL,NULL)) AS PROXY_CRE_EQU_LVL,
AVG(IIf(MTH_SB.SKILL_DESCRIPTION LIKE 'Demonstrates mastery of basic facts',MTH_SB.PERFORMANCE_VALUE_NUMERIC,NULL)) AS PROXY_DEMO_MAS_BAS_FACT,
MAX(IIf(MTH_SB.SKILL_DESCRIPTION LIKE 'Demonstrates mastery of basic facts',MTH_SB.SCALE_LOCAL,NULL)) AS PROXY_DEMO_MAS_BAS_FACT_LVL,
AVG(IIf(MTH_SB.SKILL_DESCRIPTION LIKE 'Expressions and Equations',MTH_SB.PERFORMANCE_VALUE_NUMERIC,NULL)) AS PROXY_EXP_EQU,
MAX(IIf(MTH_SB.SKILL_DESCRIPTION LIKE 'Expressions and Equations',MTH_SB.SCALE_LOCAL,NULL)) AS PROXY_EXP_EQU_LVL,
AVG(IIf(MTH_SB.SKILL_DESCRIPTION LIKE 'Functions',MTH_SB.PERFORMANCE_VALUE_NUMERIC,NULL)) AS PROXY_FUNCTIONS,
MAX(IIf(MTH_SB.SKILL_DESCRIPTION LIKE 'Functions',MTH_SB.SCALE_LOCAL,NULL)) AS PROXY_FUNCTIONS_LVL,
AVG(IIf(MTH_SB.SKILL_DESCRIPTION LIKE 'Geometry',MTH_SB.PERFORMANCE_VALUE_NUMERIC,NULL)) AS PROXY_GEOMET,
MAX(IIf(MTH_SB.SKILL_DESCRIPTION LIKE 'Geometry',MTH_SB.SCALE_LOCAL,NULL)) AS PROXY_GEOMET_LVL,
AVG(IIf(MTH_SB.SKILL_DESCRIPTION LIKE 'Geometry/Measurement',MTH_SB.PERFORMANCE_VALUE_NUMERIC,NULL)) AS PROXY_GEOMET_MEASURE,
MAX(IIf(MTH_SB.SKILL_DESCRIPTION LIKE 'Geometry/Measurement',MTH_SB.SCALE_LOCAL,NULL)) AS PROXY_GEOMET_MEASURE_LVL,
AVG(IIf(MTH_SB.SKILL_DESCRIPTION LIKE 'Mathematical Practices',MTH_SB.PERFORMANCE_VALUE_NUMERIC,NULL)) AS PROXY_MATH_PRACTICE,
MAX(IIf(MTH_SB.SKILL_DESCRIPTION LIKE 'Mathematical Practices',MTH_SB.SCALE_LOCAL,NULL)) AS PROXY_MATH_PRACTICE_LVL,
AVG(IIf(MTH_SB.SKILL_DESCRIPTION LIKE 'Measurement and Data',MTH_SB.PERFORMANCE_VALUE_NUMERIC,NULL)) AS PROXY_MEASURE_DATA,
MAX(IIf(MTH_SB.SKILL_DESCRIPTION LIKE 'Measurement and Data',MTH_SB.SCALE_LOCAL,NULL)) AS PROXY_MEASURE_DATA_LVL,
AVG(IIf(MTH_SB.SKILL_DESCRIPTION LIKE 'Number and Operations - Fractions',MTH_SB.PERFORMANCE_VALUE_NUMERIC,NULL)) AS PROXY_NUM_OPER_FRACTIONS,
MAX(IIf(MTH_SB.SKILL_DESCRIPTION LIKE 'Number and Operations - Fractions',MTH_SB.SCALE_LOCAL,NULL)) AS PROXY_NUM_OPER_FRACTIONS_LVL,
AVG(IIf(MTH_SB.SKILL_DESCRIPTION LIKE 'Number and Operations in Base Ten',MTH_SB.PERFORMANCE_VALUE_NUMERIC,NULL)) AS PROXY_NUM_OPER_BASETEN,
MAX(IIf(MTH_SB.SKILL_DESCRIPTION LIKE 'Number and Operations in Base Ten',MTH_SB.SCALE_LOCAL,NULL)) AS PROXY_NUM_OPER_BASETEN_LVL,
AVG(IIf(MTH_SB.SKILL_DESCRIPTION LIKE 'Operations and Algebraic Thinking',MTH_SB.PERFORMANCE_VALUE_NUMERIC,NULL)) AS PROXY_OPER_ALG_THINK,
MAX(IIf(MTH_SB.SKILL_DESCRIPTION LIKE 'Operations and Algebraic Thinking',MTH_SB.SCALE_LOCAL,NULL)) AS PROXY_OPER_ALG_THINK_LVL,
AVG(IIf(MTH_SB.SKILL_DESCRIPTION LIKE 'Ratio and Proportional Relationships',MTH_SB.PERFORMANCE_VALUE_NUMERIC,NULL)) AS PROXY_RATIO_PRO_REL,
MAX(IIf(MTH_SB.SKILL_DESCRIPTION LIKE 'Ratio and Proportional Relationships',MTH_SB.SCALE_LOCAL,NULL)) AS PROXY_RATIO_PRO_REL_LVL,
AVG(IIf(MTH_SB.SKILL_DESCRIPTION LIKE 'Reasoning with Equations and Inequalities',MTH_SB.PERFORMANCE_VALUE_NUMERIC,NULL)) AS PROXY_REA_EQU_INEQU,
MAX(IIf(MTH_SB.SKILL_DESCRIPTION LIKE 'Reasoning with Equations and Inequalities',MTH_SB.SCALE_LOCAL,NULL)) AS PROXY_REA_EQU_INEQU_LVL,
AVG(IIf(MTH_SB.SKILL_DESCRIPTION LIKE 'Seeing Structure in Expressions',MTH_SB.PERFORMANCE_VALUE_NUMERIC,NULL)) AS PROXY_SEE_STRUCT_EXP,
MAX(IIf(MTH_SB.SKILL_DESCRIPTION LIKE 'Seeing Structure in Expressions',MTH_SB.SCALE_LOCAL,NULL)) AS PROXY_SEE_STRUCT_EXP_LVL,
AVG(IIf(MTH_SB.SKILL_DESCRIPTION LIKE 'Statistics and Probability',MTH_SB.PERFORMANCE_VALUE_NUMERIC,NULL)) AS PROXY_STAT_PROB,
MAX(IIf(MTH_SB.SKILL_DESCRIPTION LIKE 'Statistics and Probability',MTH_SB.SCALE_LOCAL,NULL)) AS PROXY_STAT_PROB_LVL,
AVG(IIf(MTH_SB.SKILL_DESCRIPTION LIKE 'The Number System',MTH_SB.PERFORMANCE_VALUE_NUMERIC,NULL)) AS PROXY_NUM_SYS,
MAX(IIf(MTH_SB.SKILL_DESCRIPTION LIKE 'The Number System',MTH_SB.SCALE_LOCAL,NULL)) AS PROXY_NUM_SYS_LVL
FROM dbo_RPT_PERFORMANCE_LEVEL_SB AS MTH_SB
WHERE (MTH_SB.INDICATOR_AREA_ID = 5 AND MTH_SB.Tag IS NULL)
GROUP BY MTH_SB.STUDENT_ID, MTH_SB.INTERVAL;

-- (Step 1.2) QUERY SYNTAX (Create proxy data point file):

SELECT MTH_SB1.*
FROM
(*****ABOVE_QUERY*****)
AS MTH_SB1 LEFT JOIN
(*****ABOVE_QUERY*****)
AS MTH_SB2 ON (MTH_SB1.STUDENT_ID = MTH_SB2.STUDENT_ID AND MTH_SB1.PROXY_FREQUENCY_PERIOD_ID < MTH_SB2.PROXY_FREQUENCY_PERIOD_ID)
WHERE MTH_SB2.STUDENT_ID IS NULL;

-- (Step 2.1) QUERY SYNTAX (Restructure data file - pre-tagged data):

SELECT MTH_SB.STUDENT_ID, MTH_SB.INTERVAL,
AVG(MTH_SB.FREQUENCY_PERIOD_ID) AS PRE_FREQUENCY_PERIOD_ID,
MAX(IIf(MTH_SB.SKILL_DESCRIPTION LIKE 'Arithmetic with Polynomials and Rational Expressions',MTH_SB.SCALE_LOCAL,NULL)) AS PRE_ART_POL_RAT_EXP_LVL,
MAX(IIf(MTH_SB.SKILL_DESCRIPTION LIKE 'Creating Equations',MTH_SB.SCALE_LOCAL,NULL)) AS PRE_CRE_EQU_LVL,
MAX(IIf(MTH_SB.SKILL_DESCRIPTION LIKE 'Demonstrates mastery of basic facts',MTH_SB.SCALE_LOCAL,NULL)) AS PRE_DEMO_MAS_BAS_FACT_LVL,
MAX(IIf(MTH_SB.SKILL_DESCRIPTION LIKE 'Expressions and Equations',MTH_SB.SCALE_LOCAL,NULL)) AS PRE_EXP_EQU_LVL,
MAX(IIf(MTH_SB.SKILL_DESCRIPTION LIKE 'Functions',MTH_SB.SCALE_LOCAL,NULL)) AS PRE_FUNCTIONS_LVL,
MAX(IIf(MTH_SB.SKILL_DESCRIPTION LIKE 'Geometry',MTH_SB.SCALE_LOCAL,NULL)) AS PRE_GEOMET_LVL,
MAX(IIf(MTH_SB.SKILL_DESCRIPTION LIKE 'Geometry/Measurement',MTH_SB.SCALE_LOCAL,NULL)) AS PRE_GEOMET_MEASURE_LVL,
MAX(IIf(MTH_SB.SKILL_DESCRIPTION LIKE 'Mathematical Practices',MTH_SB.SCALE_LOCAL,NULL)) AS PRE_MATH_PRACTICE_LVL,
MAX(IIf(MTH_SB.SKILL_DESCRIPTION LIKE 'Measurement and Data',MTH_SB.SCALE_LOCAL,NULL)) AS PRE_MEASURE_DATA_LVL,
MAX(IIf(MTH_SB.SKILL_DESCRIPTION LIKE 'Number and Operations - Fractions',MTH_SB.SCALE_LOCAL,NULL)) AS PRE_NUM_OPER_FRACTIONS_LVL,
MAX(IIf(MTH_SB.SKILL_DESCRIPTION LIKE 'Number and Operations in Base Ten',MTH_SB.SCALE_LOCAL,NULL)) AS PRE_NUM_OPER_BASETEN_LVL,
MAX(IIf(MTH_SB.SKILL_DESCRIPTION LIKE 'Operations and Algebraic Thinking',MTH_SB.SCALE_LOCAL,NULL)) AS PRE_OPER_ALG_THINK_LVL,
MAX(IIf(MTH_SB.SKILL_DESCRIPTION LIKE 'Ratio and Proportional Relationships',MTH_SB.SCALE_LOCAL,NULL)) AS PRE_RATIO_PRO_REL_LVL,
MAX(IIf(MTH_SB.SKILL_DESCRIPTION LIKE 'Reasoning with Equations and Inequalities',MTH_SB.SCALE_LOCAL,NULL)) AS PRE_REA_EQU_INEQU_LVL,
MAX(IIf(MTH_SB.SKILL_DESCRIPTION LIKE 'Seeing Structure in Expressions',MTH_SB.SCALE_LOCAL,NULL)) AS PRE_SEE_STRUCT_EXP_LVL,
MAX(IIf(MTH_SB.SKILL_DESCRIPTION LIKE 'Statistics and Probability',MTH_SB.SCALE_LOCAL,NULL)) AS PRE_STAT_PROB_LVL,
MAX(IIf(MTH_SB.SKILL_DESCRIPTION LIKE 'The Number System',MTH_SB.SCALE_LOCAL,NULL)) AS PRE_NUM_SYS_LVL
FROM dbo_RPT_PERFORMANCE_LEVEL_SB AS MTH_SB
WHERE (MTH_SB.INDICATOR_AREA_ID = 5 AND MTH_SB.Tag LIKE 'PRE')
GROUP BY MTH_SB.STUDENT_ID, MTH_SB.INTERVAL;

-- (Step 2.2) QUERY SYNTAX (Restructure data file - post-tagged data):

SELECT MTH_SB.STUDENT_ID, MTH_SB.INTERVAL,
AVG(MTH_SB.FREQUENCY_PERIOD_ID) AS POST_FREQUENCY_PERIOD_ID,
MAX(IIf(MTH_SB.SKILL_DESCRIPTION LIKE 'Arithmetic with Polynomials and Rational Expressions',MTH_SB.SCALE_LOCAL,NULL)) AS POST_ART_POL_RAT_EXP_LVL,
MAX(IIf(MTH_SB.SKILL_DESCRIPTION LIKE 'Creating Equations',MTH_SB.SCALE_LOCAL,NULL)) AS POST_CRE_EQU_LVL,
MAX(IIf(MTH_SB.SKILL_DESCRIPTION LIKE 'Demonstrates mastery of basic facts',MTH_SB.SCALE_LOCAL,NULL)) AS POST_DEMO_MAS_BAS_FACT_LVL,
MAX(IIf(MTH_SB.SKILL_DESCRIPTION LIKE 'Expressions and Equations',MTH_SB.SCALE_LOCAL,NULL)) AS POST_EXP_EQU_LVL,
MAX(IIf(MTH_SB.SKILL_DESCRIPTION LIKE 'Functions',MTH_SB.SCALE_LOCAL,NULL)) AS POST_FUNCTIONS_LVL,
MAX(IIf(MTH_SB.SKILL_DESCRIPTION LIKE 'Geometry',MTH_SB.SCALE_LOCAL,NULL)) AS POST_GEOMET_LVL,
MAX(IIf(MTH_SB.SKILL_DESCRIPTION LIKE 'Geometry/Measurement',MTH_SB.SCALE_LOCAL,NULL)) AS POST_GEOMET_MEASURE_LVL,
MAX(IIf(MTH_SB.SKILL_DESCRIPTION LIKE 'Mathematical Practices',MTH_SB.SCALE_LOCAL,NULL)) AS POST_MATH_PRACTICE_LVL,
MAX(IIf(MTH_SB.SKILL_DESCRIPTION LIKE 'Measurement and Data',MTH_SB.SCALE_LOCAL,NULL)) AS POST_MEASURE_DATA_LVL,
MAX(IIf(MTH_SB.SKILL_DESCRIPTION LIKE 'Number and Operations - Fractions',MTH_SB.SCALE_LOCAL,NULL)) AS POST_NUM_OPER_FRACTIONS_LVL,
MAX(IIf(MTH_SB.SKILL_DESCRIPTION LIKE 'Number and Operations in Base Ten',MTH_SB.SCALE_LOCAL,NULL)) AS POST_NUM_OPER_BASETEN_LVL,
MAX(IIf(MTH_SB.SKILL_DESCRIPTION LIKE 'Operations and Algebraic Thinking',MTH_SB.SCALE_LOCAL,NULL)) AS POST_OPER_ALG_THINK_LVL,
MAX(IIf(MTH_SB.SKILL_DESCRIPTION LIKE 'Ratio and Proportional Relationships',MTH_SB.SCALE_LOCAL,NULL)) AS POST_RATIO_PRO_REL_LVL,
MAX(IIf(MTH_SB.SKILL_DESCRIPTION LIKE 'Reasoning with Equations and Inequalities',MTH_SB.SCALE_LOCAL,NULL)) AS POST_REA_EQU_INEQU_LVL,
MAX(IIf(MTH_SB.SKILL_DESCRIPTION LIKE 'Seeing Structure in Expressions',MTH_SB.SCALE_LOCAL,NULL)) AS POST_SEE_STRUCT_EXP_LVL,
MAX(IIf(MTH_SB.SKILL_DESCRIPTION LIKE 'Statistics and Probability',MTH_SB.SCALE_LOCAL,NULL)) AS POST_STAT_PROB_LVL,
MAX(IIf(MTH_SB.SKILL_DESCRIPTION LIKE 'The Number System',MTH_SB.SCALE_LOCAL,NULL)) AS POST_NUM_SYS_LVL
FROM dbo_RPT_PERFORMANCE_LEVEL_SB AS MTH_SB
WHERE (MTH_SB.INDICATOR_AREA_ID = 5 AND MTH_SB.Tag LIKE 'POST')
GROUP BY MTH_SB.STUDENT_ID, MTH_SB.INTERVAL;

-- (Step 3) QUERY SYNTAX (Join the scale_local variables with the original table dbo_ELA_SB_ELA):

SELECT MTH_SB_Orig.*, MTH_PRE_LVL.*, MTH_POST_LVL.*
FROM (dbo_EVAL_SB_MATH AS MTH_SB_Orig
LEFT JOIN
(*****ABOVE_QUERY (2.1 PRE)*****)
AS MTH_PRE_LVL
ON (MTH_SB_Orig.STUDENT_ID = MTH_PRE_LVL.STUDENT_ID))
LEFT JOIN
(*****ABOVE_QUERY (2.2 POST)*****)
AS MTH_POST_LVL
ON (MTH_SB_Orig.STUDENT_ID = MTH_POST_LVL.STUDENT_ID);

-- (Step 4) QUERY SYNTAX (Merge and concatenate -- BASED ON ABOVE QUERIES):

SELECT dbo_RPT_STUDENT_MAIN.SITE_NAME, dbo_RPT_STUDENT_MAIN.SCHOOL_NAME, dbo_RPT_STUDENT_MAIN.GRADE_ID, dbo_RPT_STUDENT_MAIN.DIPLOMAS_NOW_SCHOOL, prepost.MTH_SB_Orig.STUDENT_ID, prepost.PRE_INTERVAL, prepost.PRE_ART_POL_RAT_EXP, prepost.PRE_CRE_EQU, prepost.PRE_DEMO_MAS_BAS_FACT, prepost.PRE_EXP_EQU, prepost.PRE_FUNCTIONS, prepost.PRE_GEOMET, prepost.PRE_GEOMET_MEASURE, prepost.PRE_MATH_PRACTICE, prepost.PRE_MEASURE_DATA, prepost.PRE_NUM_OPER_FRACTIONS, prepost.PRE_NUM_OPER_BASETEN, prepost.PRE_OPER_ALG_THINK, prepost.PRE_RATIO_PRO_REL, prepost.PRE_REA_EQU_INEQU, prepost.PRE_SEE_STRUCT_EXP, prepost.PRE_STAT_PROB, prepost.PRE_NUM_SYS, prepost.POST_INTERVAL, prepost.POST_ART_POL_RAT_EXP, prepost.POST_CRE_EQU, prepost.POST_DEMO_MAS_BAS_FACT, prepost.POST_EXP_EQU, prepost.POST_FUNCTIONS, prepost.POST_GEOMET, prepost.POST_GEOMET_MEASURE, prepost.POST_MATH_PRACTICE, prepost.POST_MEASURE_DATA, prepost.POST_NUM_OPER_FRACTIONS, prepost.POST_NUM_OPER_BASETEN, prepost.POST_OPER_ALG_THINK, prepost.POST_RATIO_PRO_REL, prepost.POST_REA_EQU_INEQU, prepost.POST_SEE_STRUCT_EXP, prepost.POST_STAT_PROB, prepost.POST_NUM_SYS, prepost.CURRENTLY_ENROLLED, prepost.ENROLLED_DAYS, prepost.ENROLLED_DAYS_CATEGORIES, prepost.TTL_TIME, prepost.DOSAGE_CATEGORIES, prepost.STATUS_SITE_DOSAGE_GOAL, prepost.SITE_DOSAGE_GOAL, prepost.Attendance_IA, prepost.ELA_IA, prepost.Math_IA, prepost.Behavior_IA, prepost.MTH_PRE_LVL.STUDENT_ID, prepost.MTH_PRE_LVL.INTERVAL, prepost.PRE_FREQUENCY_PERIOD_ID, prepost.PRE_ART_POL_RAT_EXP_LVL, prepost.PRE_CRE_EQU_LVL, prepost.PRE_DEMO_MAS_BAS_FACT_LVL, prepost.PRE_EXP_EQU_LVL, prepost.PRE_FUNCTIONS_LVL, prepost.PRE_GEOMET_LVL, prepost.PRE_GEOMET_MEASURE_LVL, prepost.PRE_MATH_PRACTICE_LVL, prepost.PRE_MEASURE_DATA_LVL, prepost.PRE_NUM_OPER_FRACTIONS_LVL, prepost.PRE_NUM_OPER_BASETEN_LVL, prepost.PRE_OPER_ALG_THINK_LVL, prepost.PRE_RATIO_PRO_REL_LVL, prepost.PRE_REA_EQU_INEQU_LVL, prepost.PRE_SEE_STRUCT_EXP_LVL, prepost.PRE_STAT_PROB_LVL, prepost.PRE_NUM_SYS_LVL, prepost.MTH_POST_LVL.STUDENT_ID, prepost.MTH_POST_LVL.INTERVAL, prepost.POST_FREQUENCY_PERIOD_ID, prepost.POST_ART_POL_RAT_EXP_LVL, prepost.POST_CRE_EQU_LVL, prepost.POST_DEMO_MAS_BAS_FACT_LVL, prepost.POST_EXP_EQU_LVL, prepost.POST_FUNCTIONS_LVL, prepost.POST_GEOMET_LVL, prepost.POST_GEOMET_MEASURE_LVL, prepost.POST_MATH_PRACTICE_LVL, prepost.POST_MEASURE_DATA_LVL, prepost.POST_NUM_OPER_FRACTIONS_LVL, prepost.POST_NUM_OPER_BASETEN_LVL, prepost.POST_OPER_ALG_THINK_LVL, prepost.POST_RATIO_PRO_REL_LVL, prepost.POST_REA_EQU_INEQU_LVL, prepost.POST_SEE_STRUCT_EXP_LVL, prepost.POST_STAT_PROB_LVL, prepost.POST_NUM_SYS_LVL, MY_PROXY_MTH_SB.*,dbo_RPT_SCHOOL_GRADE.*,
IIf(dbo_RPT_STUDENT_MAIN.GRADE_ID = 21,-1,IIf(dbo_RPT_STUDENT_MAIN.GRADE_ID = 22,0,dbo_RPT_STUDENT_MAIN.GRADE_ID)) AS GRADE_ID_RECODE,
IIf(((dbo_RPT_SCHOOL_GRADE.SCHOOL_ID = 2848 Or dbo_RPT_SCHOOL_GRADE.SCHOOL_ID = 2988) And dbo_RPT_STUDENT_MAIN.GRADE_ID < 9) Or (dbo_RPT_SCHOOL_GRADE.SCHOOL_ID = 3010 And dbo_RPT_STUDENT_MAIN.GRADE_ID > 9),'0',DIPLOMAS_NOW_SCHOOL) AS DN_SCHOOL_BY_GRADE,
IIf(prepost.TTL_TIME >= dbo_RPT_SCHOOL_GRADE.B_RULE_VAL2,1,IIf(prepost.TTL_TIME < dbo_RPT_SCHOOL_GRADE.B_RULE_VAL2,0,NULL)) AS MY_MET_Q3_DOSAGE,
IIf(GRADE_ID_RECODE >= dbo_RPT_SCHOOL_GRADE.B_RULE_VAL3 AND GRADE_ID_RECODE <= dbo_RPT_SCHOOL_GRADE.B_RULE_VAL4,1,IIf(GRADE_ID_RECODE < dbo_RPT_SCHOOL_GRADE.B_RULE_VAL3 OR GRADE_ID_RECODE > dbo_RPT_SCHOOL_GRADE.B_RULE_VAL4,0,NULL)) AS MY_IN_IOG_GRADE_RANGE,
IIf(prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < MY_PROXY_MTH_SB.INTERVAL OR prepost.PRE_INTERVAL LIKE 'Math PrYr/Cumulative'),MY_PROXY_MTH_SB.INTERVAL,prepost.POST_INTERVAL) AS MY_INTERVAL,
IIf(prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < MY_PROXY_MTH_SB.INTERVAL OR prepost.PRE_INTERVAL LIKE 'Math PrYr/Cumulative'),MY_PROXY_MTH_SB.PROXY_ART_POL_RAT_EXP,prepost.POST_ART_POL_RAT_EXP) AS MY_ART_POL_RAT_EXP,
IIf(prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < MY_PROXY_MTH_SB.INTERVAL OR prepost.PRE_INTERVAL LIKE 'Math PrYr/Cumulative'),MY_PROXY_MTH_SB.PROXY_CRE_EQU,prepost.POST_CRE_EQU) AS MY_CRE_EQU,
IIf(prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < MY_PROXY_MTH_SB.INTERVAL OR prepost.PRE_INTERVAL LIKE 'Math PrYr/Cumulative'),MY_PROXY_MTH_SB.PROXY_DEMO_MAS_BAS_FACT,prepost.POST_DEMO_MAS_BAS_FACT) AS MY_DEMO_MAS_BAS_FACT,
IIf(prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < MY_PROXY_MTH_SB.INTERVAL OR prepost.PRE_INTERVAL LIKE 'Math PrYr/Cumulative'),MY_PROXY_MTH_SB.PROXY_EXP_EQU,prepost.POST_EXP_EQU) AS MY_EXP_EQU,
IIf(prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < MY_PROXY_MTH_SB.INTERVAL OR prepost.PRE_INTERVAL LIKE 'Math PrYr/Cumulative'),MY_PROXY_MTH_SB.PROXY_FUNCTIONS,prepost.POST_FUNCTIONS) AS MY_FUNCTIONS,
IIf(prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < MY_PROXY_MTH_SB.INTERVAL OR prepost.PRE_INTERVAL LIKE 'Math PrYr/Cumulative'),MY_PROXY_MTH_SB.PROXY_GEOMET,prepost.POST_GEOMET) AS MY_GEOMET,
IIf(prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < MY_PROXY_MTH_SB.INTERVAL OR prepost.PRE_INTERVAL LIKE 'Math PrYr/Cumulative'),MY_PROXY_MTH_SB.PROXY_GEOMET_MEASURE,prepost.POST_GEOMET_MEASURE) AS MY_GEOMET_MEASURE,
IIf(prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < MY_PROXY_MTH_SB.INTERVAL OR prepost.PRE_INTERVAL LIKE 'Math PrYr/Cumulative'),MY_PROXY_MTH_SB.PROXY_MATH_PRACTICE,prepost.POST_MATH_PRACTICE) AS MY_MATH_PRACTICE,
IIf(prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < MY_PROXY_MTH_SB.INTERVAL OR prepost.PRE_INTERVAL LIKE 'Math PrYr/Cumulative'),MY_PROXY_MTH_SB.PROXY_MEASURE_DATA,prepost.POST_MEASURE_DATA) AS MY_MEASURE_DATA,
IIf(prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < MY_PROXY_MTH_SB.INTERVAL OR prepost.PRE_INTERVAL LIKE 'Math PrYr/Cumulative'),MY_PROXY_MTH_SB.PROXY_NUM_OPER_FRACTIONS,prepost.POST_NUM_OPER_FRACTIONS) AS MY_NUM_OPER_FRACTIONS,
IIf(prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < MY_PROXY_MTH_SB.INTERVAL OR prepost.PRE_INTERVAL LIKE 'Math PrYr/Cumulative'),MY_PROXY_MTH_SB.PROXY_NUM_OPER_BASETEN,prepost.POST_NUM_OPER_BASETEN) AS MY_NUM_OPER_BASETEN,
IIf(prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < MY_PROXY_MTH_SB.INTERVAL OR prepost.PRE_INTERVAL LIKE 'Math PrYr/Cumulative'),MY_PROXY_MTH_SB.PROXY_OPER_ALG_THINK,prepost.POST_OPER_ALG_THINK) AS MY_OPER_ALG_THINK,
IIf(prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < MY_PROXY_MTH_SB.INTERVAL OR prepost.PRE_INTERVAL LIKE 'Math PrYr/Cumulative'),MY_PROXY_MTH_SB.PROXY_RATIO_PRO_REL,prepost.POST_RATIO_PRO_REL) AS MY_RATIO_PRO_REL,
IIf(prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < MY_PROXY_MTH_SB.INTERVAL OR prepost.PRE_INTERVAL LIKE 'Math PrYr/Cumulative'),MY_PROXY_MTH_SB.PROXY_REA_EQU_INEQU,prepost.POST_REA_EQU_INEQU) AS MY_REA_EQU_INEQU,
IIf(prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < MY_PROXY_MTH_SB.INTERVAL OR prepost.PRE_INTERVAL LIKE 'Math PrYr/Cumulative'),MY_PROXY_MTH_SB.PROXY_SEE_STRUCT_EXP,prepost.POST_SEE_STRUCT_EXP) AS MY_SEE_STRUCT_EXP,
IIf(prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < MY_PROXY_MTH_SB.INTERVAL OR prepost.PRE_INTERVAL LIKE 'Math PrYr/Cumulative'),MY_PROXY_MTH_SB.PROXY_STAT_PROB,prepost.POST_STAT_PROB) AS MY_STAT_PROB,
IIf(prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < MY_PROXY_MTH_SB.INTERVAL OR prepost.PRE_INTERVAL LIKE 'Math PrYr/Cumulative'),MY_PROXY_MTH_SB.PROXY_NUM_SYS,prepost.POST_NUM_SYS) AS MY_NUM_SYS,
IIf(prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < MY_PROXY_MTH_SB.INTERVAL OR prepost.PRE_INTERVAL LIKE 'Math PrYr/Cumulative'),MY_PROXY_MTH_SB.PROXY_ART_POL_RAT_EXP_LVL,prepost.POST_ART_POL_RAT_EXP_LVL) AS MY_ART_POL_RAT_EXP_LVL,
IIf(prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < MY_PROXY_MTH_SB.INTERVAL OR prepost.PRE_INTERVAL LIKE 'Math PrYr/Cumulative'),MY_PROXY_MTH_SB.PROXY_CRE_EQU_LVL,prepost.POST_CRE_EQU_LVL) AS MY_CRE_EQU_LVL,
IIf(prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < MY_PROXY_MTH_SB.INTERVAL OR prepost.PRE_INTERVAL LIKE 'Math PrYr/Cumulative'),MY_PROXY_MTH_SB.PROXY_DEMO_MAS_BAS_FACT_LVL,prepost.POST_DEMO_MAS_BAS_FACT_LVL) AS MY_DEMO_MAS_BAS_FACT_LVL,
IIf(prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < MY_PROXY_MTH_SB.INTERVAL OR prepost.PRE_INTERVAL LIKE 'Math PrYr/Cumulative'),MY_PROXY_MTH_SB.PROXY_EXP_EQU_LVL,prepost.POST_EXP_EQU_LVL) AS MY_EXP_EQU_LVL,
IIf(prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < MY_PROXY_MTH_SB.INTERVAL OR prepost.PRE_INTERVAL LIKE 'Math PrYr/Cumulative'),MY_PROXY_MTH_SB.PROXY_FUNCTIONS_LVL,prepost.POST_FUNCTIONS_LVL) AS MY_FUNCTIONS_LVL,
IIf(prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < MY_PROXY_MTH_SB.INTERVAL OR prepost.PRE_INTERVAL LIKE 'Math PrYr/Cumulative'),MY_PROXY_MTH_SB.PROXY_GEOMET_LVL,prepost.POST_GEOMET_LVL) AS MY_GEOMET_LVL,
IIf(prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < MY_PROXY_MTH_SB.INTERVAL OR prepost.PRE_INTERVAL LIKE 'Math PrYr/Cumulative'),MY_PROXY_MTH_SB.PROXY_GEOMET_MEASURE_LVL,prepost.POST_GEOMET_MEASURE_LVL) AS MY_GEOMET_MEASURE_LVL,
IIf(prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < MY_PROXY_MTH_SB.INTERVAL OR prepost.PRE_INTERVAL LIKE 'Math PrYr/Cumulative'),MY_PROXY_MTH_SB.PROXY_MATH_PRACTICE_LVL,prepost.POST_MATH_PRACTICE_LVL) AS MY_MATH_PRACTICE_LVL,
IIf(prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < MY_PROXY_MTH_SB.INTERVAL OR prepost.PRE_INTERVAL LIKE 'Math PrYr/Cumulative'),MY_PROXY_MTH_SB.PROXY_MEASURE_DATA_LVL,prepost.POST_MEASURE_DATA_LVL) AS MY_MEASURE_DATA_LVL,
IIf(prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < MY_PROXY_MTH_SB.INTERVAL OR prepost.PRE_INTERVAL LIKE 'Math PrYr/Cumulative'),MY_PROXY_MTH_SB.PROXY_NUM_OPER_FRACTIONS_LVL,prepost.POST_NUM_OPER_FRACTIONS_LVL) AS MY_NUM_OPER_FRACTIONS_LVL,
IIf(prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < MY_PROXY_MTH_SB.INTERVAL OR prepost.PRE_INTERVAL LIKE 'Math PrYr/Cumulative'),MY_PROXY_MTH_SB.PROXY_NUM_OPER_BASETEN_LVL,prepost.POST_NUM_OPER_BASETEN_LVL) AS MY_NUM_OPER_BASETEN_LVL,
IIf(prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < MY_PROXY_MTH_SB.INTERVAL OR prepost.PRE_INTERVAL LIKE 'Math PrYr/Cumulative'),MY_PROXY_MTH_SB.PROXY_OPER_ALG_THINK_LVL,prepost.POST_OPER_ALG_THINK_LVL) AS MY_OPER_ALG_THINK_LVL,
IIf(prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < MY_PROXY_MTH_SB.INTERVAL OR prepost.PRE_INTERVAL LIKE 'Math PrYr/Cumulative'),MY_PROXY_MTH_SB.PROXY_RATIO_PRO_REL_LVL,prepost.POST_RATIO_PRO_REL_LVL) AS MY_RATIO_PRO_REL_LVL,
IIf(prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < MY_PROXY_MTH_SB.INTERVAL OR prepost.PRE_INTERVAL LIKE 'Math PrYr/Cumulative'),MY_PROXY_MTH_SB.PROXY_REA_EQU_INEQU_LVL,prepost.POST_REA_EQU_INEQU_LVL) AS MY_REA_EQU_INEQU_LVL,
IIf(prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < MY_PROXY_MTH_SB.INTERVAL OR prepost.PRE_INTERVAL LIKE 'Math PrYr/Cumulative'),MY_PROXY_MTH_SB.PROXY_SEE_STRUCT_EXP_LVL,prepost.POST_SEE_STRUCT_EXP_LVL) AS MY_SEE_STRUCT_EXP_LVL,
IIf(prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < MY_PROXY_MTH_SB.INTERVAL OR prepost.PRE_INTERVAL LIKE 'Math PrYr/Cumulative'),MY_PROXY_MTH_SB.PROXY_STAT_PROB_LVL,prepost.POST_STAT_PROB_LVL) AS MY_STAT_PROB_LVL,
IIf(prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < MY_PROXY_MTH_SB.INTERVAL OR prepost.PRE_INTERVAL LIKE 'Math PrYr/Cumulative'),MY_PROXY_MTH_SB.PROXY_NUM_SYS_LVL,prepost.POST_NUM_SYS_LVL) AS MY_NUM_SYS_LVL,
IIf(prepost.PRE_ART_POL_RAT_EXP IS NOT NULL AND MY_ART_POL_RAT_EXP IS NOT NULL,MY_ART_POL_RAT_EXP - prepost.PRE_ART_POL_RAT_EXP,NULL) AS MY_ART_POL_RAT_EXP_CHANGE,
IIf(prepost.PRE_CRE_EQU IS NOT NULL AND MY_CRE_EQU IS NOT NULL,MY_CRE_EQU - prepost.PRE_CRE_EQU,NULL) AS MY_CRE_EQU_CHANGE,
IIf(prepost.PRE_DEMO_MAS_BAS_FACT IS NOT NULL AND MY_DEMO_MAS_BAS_FACT IS NOT NULL,MY_DEMO_MAS_BAS_FACT - prepost.PRE_DEMO_MAS_BAS_FACT,NULL) AS MY_DEMO_MAS_BAS_FACT_CHANGE,
IIf(prepost.PRE_EXP_EQU IS NOT NULL AND MY_EXP_EQU IS NOT NULL,MY_EXP_EQU - prepost.PRE_EXP_EQU,NULL) AS MY_EXP_EQU_CHANGE,
IIf(prepost.PRE_FUNCTIONS IS NOT NULL AND MY_FUNCTIONS IS NOT NULL,MY_FUNCTIONS - prepost.PRE_FUNCTIONS,NULL) AS MY_FUNCTIONS_CHANGE,
IIf(prepost.PRE_GEOMET IS NOT NULL AND MY_GEOMET IS NOT NULL,MY_GEOMET - prepost.PRE_GEOMET, NULL) AS MY_GEOMET_CHANGE,
IIf(prepost.PRE_GEOMET_MEASURE IS NOT NULL AND MY_GEOMET_MEASURE IS NOT NULL,MY_GEOMET_MEASURE - prepost.PRE_GEOMET_MEASURE,NULL) AS MY_GEOMET_MEASURE_CHANGE,
IIf(prepost.PRE_MATH_PRACTICE IS NOT NULL AND MY_MATH_PRACTICE IS NOT NULL,MY_MATH_PRACTICE - prepost.PRE_MATH_PRACTICE,NULL) AS MY_MATH_PRACTICE_CHANGE,
IIf(prepost.PRE_MEASURE_DATA IS NOT NULL AND MY_MEASURE_DATA IS NOT NULL,MY_MEASURE_DATA - prepost.PRE_MEASURE_DATA,NULL) AS MY_MEASURE_DATA_CHANGE,
IIf(prepost.PRE_NUM_OPER_FRACTIONS IS NOT NULL AND MY_NUM_OPER_FRACTIONS IS NOT NULL,MY_NUM_OPER_FRACTIONS - prepost.PRE_NUM_OPER_FRACTIONS,NULL) AS MY_NUM_OPER_FRACTIONS_CHANGE,
IIf(prepost.PRE_NUM_OPER_BASETEN IS NOT NULL AND MY_NUM_OPER_BASETEN IS NOT NULL,MY_NUM_OPER_BASETEN - prepost.PRE_NUM_OPER_BASETEN,NULL) AS MY_NUM_OPER_BASETEN_CHANGE,
IIf(prepost.PRE_OPER_ALG_THINK IS NOT NULL AND MY_OPER_ALG_THINK IS NOT NULL,MY_OPER_ALG_THINK - prepost.PRE_OPER_ALG_THINK,NULL) AS MY_OPER_ALG_THINK_CHANGE,
IIf(prepost.PRE_RATIO_PRO_REL IS NOT NULL AND MY_RATIO_PRO_REL IS NOT NULL,MY_RATIO_PRO_REL - prepost.PRE_RATIO_PRO_REL,NULL) AS MY_RATIO_PRO_REL_CHANGE,
IIf(prepost.PRE_REA_EQU_INEQU IS NOT NULL AND MY_REA_EQU_INEQU IS NOT NULL,MY_REA_EQU_INEQU - prepost.PRE_REA_EQU_INEQU,NULL) AS MY_REA_EQU_INEQU_CHANGE,
IIf(prepost.PRE_SEE_STRUCT_EXP IS NOT NULL AND MY_SEE_STRUCT_EXP IS NOT NULL,MY_SEE_STRUCT_EXP - prepost.PRE_SEE_STRUCT_EXP,NULL) AS MY_SEE_STRUCT_EXP_CHANGE,
IIf(prepost.PRE_STAT_PROB IS NOT NULL AND MY_STAT_PROB IS NOT NULL,MY_STAT_PROB - prepost.PRE_STAT_PROB,NULL) AS MY_STAT_PROB_CHANGE,
IIf(prepost.PRE_NUM_SYS IS NOT NULL AND MY_NUM_SYS IS NOT NULL,MY_NUM_SYS - prepost.PRE_NUM_SYS,NULL) AS MY_NUM_SYS_CHANGE,
IIf(prepost.PRE_ART_POL_RAT_EXP_LVL IS NOT NULL AND MY_ART_POL_RAT_EXP_LVL IS NOT NULL,prepost.PRE_ART_POL_RAT_EXP_LVL & ' to ' & MY_ART_POL_RAT_EXP_LVL,NULL) AS MY_ART_POL_RAT_EXP_PERFCHANGE,
IIf(prepost.PRE_CRE_EQU_LVL IS NOT NULL AND MY_CRE_EQU_LVL IS NOT NULL,prepost.PRE_CRE_EQU_LVL & ' to ' & MY_CRE_EQU_LVL,NULL) AS MY_CRE_EQU_PERFCHANGE,
IIf(prepost.PRE_DEMO_MAS_BAS_FACT_LVL IS NOT NULL AND MY_DEMO_MAS_BAS_FACT_LVL IS NOT NULL,prepost.PRE_DEMO_MAS_BAS_FACT_LVL & ' to ' & MY_DEMO_MAS_BAS_FACT_LVL,NULL) AS MY_DEMO_MAS_BAS_FACT_PERFCHANGE,
IIf(prepost.PRE_EXP_EQU_LVL IS NOT NULL AND MY_EXP_EQU_LVL IS NOT NULL,prepost.PRE_EXP_EQU_LVL & ' to ' & MY_EXP_EQU_LVL,NULL) AS MY_EXP_EQU_PERFCHANGE,
IIf(prepost.PRE_FUNCTIONS_LVL IS NOT NULL AND MY_FUNCTIONS_LVL IS NOT NULL,prepost.PRE_FUNCTIONS_LVL & ' to ' & MY_FUNCTIONS_LVL,NULL) AS MY_FUNCTIONS_PERFCHANGE,
IIf(prepost.PRE_GEOMET_LVL IS NOT NULL AND MY_GEOMET_LVL IS NOT NULL,prepost.PRE_GEOMET_LVL & ' to ' & MY_GEOMET_LVL, NULL) AS MY_GEOMET_PERFCHANGE,
IIf(prepost.PRE_GEOMET_MEASURE_LVL IS NOT NULL AND MY_GEOMET_MEASURE_LVL IS NOT NULL,prepost.PRE_GEOMET_MEASURE_LVL & ' to ' & MY_GEOMET_MEASURE_LVL,NULL) AS MY_GEOMET_MEASURE_PERFCHANGE,
IIf(prepost.PRE_MATH_PRACTICE_LVL IS NOT NULL AND MY_MATH_PRACTICE_LVL IS NOT NULL,prepost.PRE_MATH_PRACTICE_LVL & ' to ' & MY_MATH_PRACTICE_LVL,NULL) AS MY_MATH_PRACTICE_PERFCHANGE,
IIf(prepost.PRE_MEASURE_DATA_LVL IS NOT NULL AND MY_MEASURE_DATA_LVL IS NOT NULL,prepost.PRE_MEASURE_DATA_LVL & ' to ' & MY_MEASURE_DATA_LVL,NULL) AS MY_MEASURE_DATA_PERFCHANGE,
IIf(prepost.PRE_NUM_OPER_FRACTIONS_LVL IS NOT NULL AND MY_NUM_OPER_FRACTIONS_LVL IS NOT NULL,prepost.PRE_NUM_OPER_FRACTIONS_LVL & ' to ' & MY_NUM_OPER_FRACTIONS_LVL,NULL) AS MY_NUM_OPER_FRACTIONS_PERFCHANGE,
IIf(prepost.PRE_NUM_OPER_BASETEN_LVL IS NOT NULL AND MY_NUM_OPER_BASETEN_LVL IS NOT NULL,prepost.PRE_NUM_OPER_BASETEN_LVL & ' to ' & MY_NUM_OPER_BASETEN_LVL,NULL) AS MY_NUM_OPER_BASETEN_PERFCHANGE,
IIf(prepost.PRE_OPER_ALG_THINK_LVL IS NOT NULL AND MY_OPER_ALG_THINK_LVL IS NOT NULL,prepost.PRE_OPER_ALG_THINK_LVL & ' to ' & MY_OPER_ALG_THINK_LVL,NULL) AS MY_OPER_ALG_THINK_PERFCHANGE,
IIf(prepost.PRE_RATIO_PRO_REL_LVL IS NOT NULL AND MY_RATIO_PRO_REL_LVL IS NOT NULL,prepost.PRE_RATIO_PRO_REL_LVL & ' to ' & MY_RATIO_PRO_REL_LVL,NULL) AS MY_RATIO_PRO_REL_PERFCHANGE,
IIf(prepost.PRE_REA_EQU_INEQU_LVL IS NOT NULL AND MY_REA_EQU_INEQU_LVL IS NOT NULL,prepost.PRE_REA_EQU_INEQU_LVL & ' to ' & MY_REA_EQU_INEQU_LVL,NULL) AS MY_REA_EQU_INEQU_PERFCHANGE,
IIf(prepost.PRE_SEE_STRUCT_EXP_LVL IS NOT NULL AND MY_SEE_STRUCT_EXP_LVL IS NOT NULL,prepost.PRE_SEE_STRUCT_EXP_LVL & ' to ' & MY_SEE_STRUCT_EXP_LVL,NULL) AS MY_SEE_STRUCT_EXP_PERFCHANGE,
IIf(prepost.PRE_STAT_PROB_LVL IS NOT NULL AND MY_STAT_PROB_LVL IS NOT NULL,prepost.PRE_STAT_PROB_LVL & ' to ' & MY_STAT_PROB_LVL,NULL) AS MY_STAT_PROB_PERFCHANGE,
IIf(prepost.PRE_NUM_SYS_LVL IS NOT NULL AND MY_NUM_SYS_LVL IS NOT NULL,prepost.PRE_NUM_SYS_LVL & ' to ' & MY_NUM_SYS_LVL,NULL) AS MY_NUM_SYS_PERFCHANGE
FROM dbo_RPT_SCHOOL_GRADE INNER JOIN (dbo_RPT_STUDENT_MAIN INNER JOIN ((*****ABOVE QUERY 3*****) AS prepost LEFT JOIN
(*****ABOVE_QUERY 1.2*****)
AS MY_PROXY_MTH_SB ON (prepost.MTH_SB_Orig.STUDENT_ID = MY_PROXY_MTH_SB.STUDENT_ID))
ON (dbo_RPT_STUDENT_MAIN.STUDENT_ID = prepost.MTH_SB_Orig.STUDENT_ID))
ON (dbo_RPT_SCHOOL_GRADE.SCHOOL_ID = dbo_RPT_STUDENT_MAIN.SCHOOL_ID AND dbo_RPT_SCHOOL_GRADE.INDICATOR_ID = 5)
WHERE dbo_RPT_SCHOOL_GRADE.GRADE_ID = dbo_RPT_STUDENT_MAIN.GRADE_ID
ORDER BY dbo_RPT_STUDENT_MAIN.SITE_NAME, dbo_RPT_STUDENT_MAIN.SCHOOL_NAME,dbo_RPT_STUDENT_MAIN.GRADE_ID,prepost.MTH_SB_Orig.STUDENT_ID;

-- QUERY SYNTAX (Merge and concatenate -- SINGLE QUERY VERSION):
***** Not using a single query version here - too complex for now. *****