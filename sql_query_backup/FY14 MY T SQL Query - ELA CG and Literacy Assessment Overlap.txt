-- Select all pre/post/proxy literacy assessment and merge with all pre/post/proxy ELA CG data.

-- QUERY SYNTAX (BASED ON ELA CG/LIT ASSESS QUERIES -- STEP 1):

SELECT ppp_LITAssess.SITE_NAME, ppp_LITAssess.SCHOOL_NAME, ppp_LITAssess.GRADE_ID, ppp_LITAssess.DIPLOMAS_NOW_SCHOOL, ppp_LITAssess.STUDENT_ID, ppp_LITAssess.SCHOOL_ID, ppp_LITAssess.TTL_TIME, ppp_LITAssess.ENROLLED_DAYS, ppp_LITAssess.ENROLLED_DAYS_CATEGORIES, ppp_LITAssess.SITE_DOSAGE_GOAL, ppp_LITAssess.STATUS_SITE_DOSAGE_GOAL, ppp_LITAssess.Attendance_IA, ppp_LITAssess.ELA_IA, ppp_LITAssess.Math_IA, ppp_LITAssess.Behavior_IA, ppp_LITAssess.B_RULE_VAL1, ppp_LITAssess.B_RULE_VAL2, ppp_LITAssess.B_RULE_VAL3, ppp_LITAssess.B_RULE_VAL4, ppp_LITAssess.GRADE_ID_RECODE, ppp_LITAssess.DN_SCHOOL_BY_GRADE, ppp_LITAssess.MY_MET_Q3_DOSAGE, ppp_LITAssess.MY_IN_IOG_GRADE_RANGE, ppp_LITAssess.PRE_DATE, ppp_LITAssess.PRE_DESC, ppp_LITAssess.PRE_VALUE_NUM, ppp_LITAssess.PRE_TRACK, ppp_LITAssess.PRE_TRACK_EVAL, ppp_LITAssess.MY_PERF_DATE, ppp_LITAssess.MY_VALUE_NUM, ppp_LITAssess.MY_TRACK, ppp_LITAssess.MY_TRACK_EVAL, ppp_LITAssess.MY_RAWCHANGE_DEGREE, ppp_LITAssess.MY_PERFORMANCECHANGE_LOCAL, ppp_LITAssess.MY_PERFORMANCECHANGE_NORMALIZED, ppp_ELA_CG.PRE_ELA_FREQ, ppp_ELA_CG.PRE_ELA_TRACK, ppp_ELA_CG.PRE_LETTER_VIEW, ppp_ELA_CG.PRE_CG_LETTER_SCALE_ALL, ppp_ELA_CG.MY_ELA_FREQ, ppp_ELA_CG.MY_ELA_TRACK, ppp_ELA_CG.MY_LETTER_VIEW, ppp_ELA_CG.MY_CG_LETTER_SCALE_ALL, ppp_ELA_CG.MY_LETTERGRADE_CHANGE_ACTUAL, ppp_ELA_CG.MY_Change, ppp_ELA_CG.MY_PERF_CHANGE,
CASE WHEN (ppp_LITAssess.PRE_TRACK_EVAL LIKE 'OFF TRACK' OR ppp_LITAssess.PRE_TRACK_EVAL LIKE 'SLIDING') AND (ppp_ELA_CG.PRE_ELA_TRACK LIKE 'OFF TRACK' OR ppp_ELA_CG.PRE_ELA_TRACK LIKE 'SLIDING') THEN 'Off-Track/Sliding in Assessments, Off-Track/Sliding in ELA CG' WHEN (ppp_LITAssess.PRE_TRACK_EVAL LIKE 'OFF TRACK' OR ppp_LITAssess.PRE_TRACK_EVAL LIKE 'SLIDING') AND (ppp_ELA_CG.PRE_ELA_TRACK LIKE 'ON TRACK') THEN 'Off-Track/Sliding in Assessments, On-Track in ELA CG' WHEN (ppp_LITAssess.PRE_TRACK_EVAL LIKE 'ON TRACK') AND (ppp_ELA_CG.PRE_ELA_TRACK LIKE 'OFF TRACK' OR ppp_ELA_CG.PRE_ELA_TRACK LIKE 'SLIDING') THEN 'On-Track in Assessments, Off-Track/Sliding in ELA CG' WHEN (ppp_LITAssess.PRE_TRACK_EVAL LIKE 'ON TRACK') AND (ppp_ELA_CG.PRE_ELA_TRACK LIKE 'ON TRACK') THEN 'On-Track in Assessments, On-Track in ELA CG' ELSE NULL END AS MY_LIT_ELA_PRE_COMPARE,
CASE WHEN (ppp_LITAssess.PRE_TRACK_EVAL LIKE 'OFF TRACK' OR ppp_LITAssess.PRE_TRACK_EVAL LIKE 'SLIDING') AND (ppp_ELA_CG.PRE_ELA_TRACK LIKE 'OFF TRACK' OR ppp_ELA_CG.PRE_ELA_TRACK LIKE 'SLIDING') THEN 4 WHEN (ppp_LITAssess.PRE_TRACK_EVAL LIKE 'OFF TRACK' OR ppp_LITAssess.PRE_TRACK_EVAL LIKE 'SLIDING') AND (ppp_ELA_CG.PRE_ELA_TRACK LIKE 'ON TRACK') THEN 3 WHEN (ppp_LITAssess.PRE_TRACK_EVAL LIKE 'ON TRACK') AND (ppp_ELA_CG.PRE_ELA_TRACK LIKE 'OFF TRACK' OR ppp_ELA_CG.PRE_ELA_TRACK LIKE 'SLIDING') THEN 2 WHEN (ppp_LITAssess.PRE_TRACK_EVAL LIKE 'ON TRACK') AND (ppp_ELA_CG.PRE_ELA_TRACK LIKE 'ON TRACK') THEN 1 ELSE NULL END AS MY_LIT_ELA_PRE_COMPARE_NUM,
CASE WHEN (ppp_LITAssess.MY_TRACK_EVAL LIKE 'OFF TRACK' OR ppp_LITAssess.MY_TRACK_EVAL LIKE 'SLIDING') AND (ppp_ELA_CG.MY_ELA_TRACK LIKE 'OFF TRACK' OR ppp_ELA_CG.MY_ELA_TRACK LIKE 'SLIDING') THEN 'Off-Track/Sliding in Assessments, Off-Track/Sliding in ELA CG' WHEN (ppp_LITAssess.MY_TRACK_EVAL LIKE 'OFF TRACK' OR ppp_LITAssess.MY_TRACK_EVAL LIKE 'SLIDING') AND (ppp_ELA_CG.MY_ELA_TRACK LIKE 'ON TRACK') THEN 'Off-Track/Sliding in Assessments, On-Track in ELA CG' WHEN (ppp_LITAssess.MY_TRACK_EVAL LIKE 'ON TRACK') AND (ppp_ELA_CG.MY_ELA_TRACK LIKE 'OFF TRACK' OR ppp_ELA_CG.MY_ELA_TRACK LIKE 'SLIDING') THEN 'On-Track in Assessments, Off-Track/Sliding in ELA CG' WHEN (ppp_LITAssess.MY_TRACK_EVAL LIKE 'ON TRACK') AND (ppp_ELA_CG.MY_ELA_TRACK LIKE 'ON TRACK') THEN 'On-Track in Assessments, On-Track in ELA CG' ELSE NULL END AS MY_LIT_ELA_POST_COMPARE,
CASE WHEN (ppp_LITAssess.MY_TRACK_EVAL LIKE 'OFF TRACK' OR ppp_LITAssess.MY_TRACK_EVAL LIKE 'SLIDING') AND (ppp_ELA_CG.MY_ELA_TRACK LIKE 'OFF TRACK' OR ppp_ELA_CG.MY_ELA_TRACK LIKE 'SLIDING') THEN 4 WHEN (ppp_LITAssess.MY_TRACK_EVAL LIKE 'OFF TRACK' OR ppp_LITAssess.MY_TRACK_EVAL LIKE 'SLIDING') AND (ppp_ELA_CG.MY_ELA_TRACK LIKE 'ON TRACK') THEN 3 WHEN (ppp_LITAssess.MY_TRACK_EVAL LIKE 'ON TRACK') AND (ppp_ELA_CG.MY_ELA_TRACK LIKE 'OFF TRACK' OR ppp_ELA_CG.MY_ELA_TRACK LIKE 'SLIDING') THEN 2 WHEN (ppp_LITAssess.MY_TRACK_EVAL LIKE 'ON TRACK') AND (ppp_ELA_CG.MY_ELA_TRACK LIKE 'ON TRACK') THEN 1 ELSE NULL END AS MY_LIT_ELA_POST_COMPARE_NUM
FROM
(*****LIT PPP QUERY*****)
AS ppp_LITAssess INNER JOIN
(*****ELA CG PPP QUERY*****)
AS ppp_ELA_CG
ON ppp_LITAssess.STUDENT_ID = ppp_ELA_CG.STUDENT_ID;

-- QUERY SYNTAX (BASED ON ABOVE QUERY -- STEP 2 -- this extra step is required since calculations/joins on new variables can't reference variables that were just created in the same query):

SELECT PPPFINAL.*,
CASE WHEN PPPFINAL.MY_LIT_ELA_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in ELA CG' AND PPPFINAL.MY_LIT_ELA_POST_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in ELA CG' THEN 'Remained Off-Track/Sliding in Assessments and ELA CG' WHEN PPPFINAL.MY_LIT_ELA_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in ELA CG' AND PPPFINAL.MY_LIT_ELA_POST_COMPARE LIKE 'On-Track in Assessments, On-Track in ELA CG' THEN 'Moved On-Track in Both Assessments and ELA CG' WHEN PPPFINAL.MY_LIT_ELA_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in ELA CG' AND PPPFINAL.MY_LIT_ELA_POST_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in ELA CG' THEN 'Remained Off-Track/Sliding in Assessments, Moved On-Track in ELA CG' WHEN PPPFINAL.MY_LIT_ELA_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in ELA CG' AND PPPFINAL.MY_LIT_ELA_POST_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in ELA CG' THEN 'Moved On-Track in Assessments, Remained Off-Track/Sliding in ELA CG' ELSE NULL END AS MY_LITOFF_ELAOFF_CHANGE,
CASE WHEN PPPFINAL.MY_LIT_ELA_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in ELA CG' AND PPPFINAL.MY_LIT_ELA_POST_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in ELA CG' THEN 4 WHEN PPPFINAL.MY_LIT_ELA_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in ELA CG' AND PPPFINAL.MY_LIT_ELA_POST_COMPARE LIKE 'On-Track in Assessments, On-Track in ELA CG' THEN 1 WHEN PPPFINAL.MY_LIT_ELA_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in ELA CG' AND PPPFINAL.MY_LIT_ELA_POST_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in ELA CG' THEN 3 WHEN PPPFINAL.MY_LIT_ELA_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in ELA CG' AND PPPFINAL.MY_LIT_ELA_POST_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in ELA CG' THEN 2 ELSE NULL END AS MY_LITOFF_ELAOFF_CHANGE_NUM,
CASE WHEN PPPFINAL.MY_LIT_ELA_PRE_COMPARE LIKE 'On-Track in Assessments, On-Track in ELA CG' AND PPPFINAL.MY_LIT_ELA_POST_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in ELA CG' THEN 'Moved Off-Track/Sliding in Both Assessments and ELA CG' WHEN PPPFINAL.MY_LIT_ELA_PRE_COMPARE LIKE 'On-Track in Assessments, On-Track in ELA CG' AND PPPFINAL.MY_LIT_ELA_POST_COMPARE LIKE 'On-Track in Assessments, On-Track in ELA CG' THEN 'Remained On-Track in Assessments and ELA CG' WHEN PPPFINAL.MY_LIT_ELA_PRE_COMPARE LIKE 'On-Track in Assessments, On-Track in ELA CG' AND PPPFINAL.MY_LIT_ELA_POST_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in ELA CG' THEN 'Moved Off-Track/Sliding in Assessments, Remained On-Track in ELA CG' WHEN PPPFINAL.MY_LIT_ELA_PRE_COMPARE LIKE 'On-Track in Assessments, On-Track in ELA CG' AND PPPFINAL.MY_LIT_ELA_POST_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in ELA CG' THEN 'Remained On-Track in Assessments, Moved Off-Track/Sliding in ELA CG' ELSE NULL END AS MY_LITON_ELAON_CHANGE,
CASE WHEN PPPFINAL.MY_LIT_ELA_PRE_COMPARE LIKE 'On-Track in Assessments, On-Track in ELA CG' AND PPPFINAL.MY_LIT_ELA_POST_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in ELA CG' THEN 4 WHEN PPPFINAL.MY_LIT_ELA_PRE_COMPARE LIKE 'On-Track in Assessments, On-Track in ELA CG' AND PPPFINAL.MY_LIT_ELA_POST_COMPARE LIKE 'On-Track in Assessments, On-Track in ELA CG' THEN 1 WHEN PPPFINAL.MY_LIT_ELA_PRE_COMPARE LIKE 'On-Track in Assessments, On-Track in ELA CG' AND PPPFINAL.MY_LIT_ELA_POST_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in ELA CG' THEN 3 WHEN PPPFINAL.MY_LIT_ELA_PRE_COMPARE LIKE 'On-Track in Assessments, On-Track in ELA CG' AND PPPFINAL.MY_LIT_ELA_POST_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in ELA CG' THEN 2 ELSE NULL END AS MY_LITON_ELAON_CHANGE_NUM,
CASE WHEN PPPFINAL.MY_LIT_ELA_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in ELA CG' AND PPPFINAL.MY_LIT_ELA_POST_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in ELA CG' THEN 'Remained Off-Track/Sliding in Assessments, Moved Off-Track/Sliding in ELA CG' WHEN PPPFINAL.MY_LIT_ELA_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in ELA CG' AND PPPFINAL.MY_LIT_ELA_POST_COMPARE LIKE 'On-Track in Assessments, On-Track in ELA CG' THEN 'Moved On-Track in Assessments and Remained On-Track in ELA CG' WHEN PPPFINAL.MY_LIT_ELA_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in ELA CG' AND PPPFINAL.MY_LIT_ELA_POST_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in ELA CG' THEN 'Remained Off-Track/Sliding in Assessments, Remained On-Track in ELA CG' WHEN PPPFINAL.MY_LIT_ELA_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in ELA CG' AND PPPFINAL.MY_LIT_ELA_POST_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in ELA CG' THEN 'Moved On-Track in Assessments, Moved Off-Track/Sliding in ELA CG' ELSE NULL END AS MY_LITOFF_ELAON_CHANGE,
CASE WHEN PPPFINAL.MY_LIT_ELA_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in ELA CG' AND PPPFINAL.MY_LIT_ELA_POST_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in ELA CG' THEN 4 WHEN PPPFINAL.MY_LIT_ELA_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in ELA CG' AND PPPFINAL.MY_LIT_ELA_POST_COMPARE LIKE 'On-Track in Assessments, On-Track in ELA CG' THEN 1 WHEN PPPFINAL.MY_LIT_ELA_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in ELA CG' AND PPPFINAL.MY_LIT_ELA_POST_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in ELA CG' THEN 3 WHEN PPPFINAL.MY_LIT_ELA_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in ELA CG' AND PPPFINAL.MY_LIT_ELA_POST_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in ELA CG' THEN 2 ELSE NULL END AS MY_LITOFF_ELAON_CHANGE_NUM,
CASE WHEN PPPFINAL.MY_LIT_ELA_PRE_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in ELA CG' AND PPPFINAL.MY_LIT_ELA_POST_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in ELA CG' THEN 'Moved Off-Track/Sliding in Assessments, Remained Off-Track/Sliding in ELA CG' WHEN PPPFINAL.MY_LIT_ELA_PRE_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in ELA CG' AND PPPFINAL.MY_LIT_ELA_POST_COMPARE LIKE 'On-Track in Assessments, On-Track in ELA CG' THEN 'Remained On-Track in Assessments, Moved On-Track in ELA CG' WHEN PPPFINAL.MY_LIT_ELA_PRE_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in ELA CG' AND PPPFINAL.MY_LIT_ELA_POST_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in ELA CG' THEN 'Moved Off-Track/Sliding in Assessments, Moved On-Track in ELA CG' WHEN PPPFINAL.MY_LIT_ELA_PRE_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in ELA CG' AND PPPFINAL.MY_LIT_ELA_POST_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in ELA CG' THEN 'Remained On-Track in Assessments, Remained Off-Track/Sliding in ELA CG' ELSE NULL END AS MY_LITON_ELAOFF_CHANGE,
CASE WHEN PPPFINAL.MY_LIT_ELA_PRE_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in ELA CG' AND PPPFINAL.MY_LIT_ELA_POST_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in ELA CG' THEN 4 WHEN PPPFINAL.MY_LIT_ELA_PRE_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in ELA CG' AND PPPFINAL.MY_LIT_ELA_POST_COMPARE LIKE 'On-Track in Assessments, On-Track in ELA CG' THEN 1 WHEN PPPFINAL.MY_LIT_ELA_PRE_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in ELA CG' AND PPPFINAL.MY_LIT_ELA_POST_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in ELA CG' THEN 3 WHEN PPPFINAL.MY_LIT_ELA_PRE_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in ELA CG' AND PPPFINAL.MY_LIT_ELA_POST_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in ELA CG' THEN 2 ELSE NULL END AS MY_LITON_ELAOFF_CHANGE_NUM
FROM
(*****ABOVE_QUERY*****)
AS PPPFINAL
ORDER BY SITE_NAME, SCHOOL_NAME, GRADE_ID, STUDENT_ID;

-- QUERY SYNTAX (SINGLE QUERY VERSION):

SELECT PPPFINAL.*,
CASE WHEN PPPFINAL.MY_LIT_ELA_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in ELA CG' AND PPPFINAL.MY_LIT_ELA_POST_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in ELA CG' THEN 'Remained Off-Track/Sliding in Assessments and ELA CG' WHEN PPPFINAL.MY_LIT_ELA_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in ELA CG' AND PPPFINAL.MY_LIT_ELA_POST_COMPARE LIKE 'On-Track in Assessments, On-Track in ELA CG' THEN 'Moved On-Track in Both Assessments and ELA CG' WHEN PPPFINAL.MY_LIT_ELA_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in ELA CG' AND PPPFINAL.MY_LIT_ELA_POST_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in ELA CG' THEN 'Remained Off-Track/Sliding in Assessments, Moved On-Track in ELA CG' WHEN PPPFINAL.MY_LIT_ELA_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in ELA CG' AND PPPFINAL.MY_LIT_ELA_POST_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in ELA CG' THEN 'Moved On-Track in Assessments, Remained Off-Track/Sliding in ELA CG' ELSE NULL END AS MY_LITOFF_ELAOFF_CHANGE,
CASE WHEN PPPFINAL.MY_LIT_ELA_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in ELA CG' AND PPPFINAL.MY_LIT_ELA_POST_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in ELA CG' THEN 4 WHEN PPPFINAL.MY_LIT_ELA_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in ELA CG' AND PPPFINAL.MY_LIT_ELA_POST_COMPARE LIKE 'On-Track in Assessments, On-Track in ELA CG' THEN 1 WHEN PPPFINAL.MY_LIT_ELA_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in ELA CG' AND PPPFINAL.MY_LIT_ELA_POST_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in ELA CG' THEN 3 WHEN PPPFINAL.MY_LIT_ELA_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in ELA CG' AND PPPFINAL.MY_LIT_ELA_POST_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in ELA CG' THEN 2 ELSE NULL END AS MY_LITOFF_ELAOFF_CHANGE_NUM,
CASE WHEN PPPFINAL.MY_LIT_ELA_PRE_COMPARE LIKE 'On-Track in Assessments, On-Track in ELA CG' AND PPPFINAL.MY_LIT_ELA_POST_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in ELA CG' THEN 'Moved Off-Track/Sliding in Both Assessments and ELA CG' WHEN PPPFINAL.MY_LIT_ELA_PRE_COMPARE LIKE 'On-Track in Assessments, On-Track in ELA CG' AND PPPFINAL.MY_LIT_ELA_POST_COMPARE LIKE 'On-Track in Assessments, On-Track in ELA CG' THEN 'Remained On-Track in Assessments and ELA CG' WHEN PPPFINAL.MY_LIT_ELA_PRE_COMPARE LIKE 'On-Track in Assessments, On-Track in ELA CG' AND PPPFINAL.MY_LIT_ELA_POST_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in ELA CG' THEN 'Moved Off-Track/Sliding in Assessments, Remained On-Track in ELA CG' WHEN PPPFINAL.MY_LIT_ELA_PRE_COMPARE LIKE 'On-Track in Assessments, On-Track in ELA CG' AND PPPFINAL.MY_LIT_ELA_POST_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in ELA CG' THEN 'Remained On-Track in Assessments, Moved Off-Track/Sliding in ELA CG' ELSE NULL END AS MY_LITON_ELAON_CHANGE,
CASE WHEN PPPFINAL.MY_LIT_ELA_PRE_COMPARE LIKE 'On-Track in Assessments, On-Track in ELA CG' AND PPPFINAL.MY_LIT_ELA_POST_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in ELA CG' THEN 4 WHEN PPPFINAL.MY_LIT_ELA_PRE_COMPARE LIKE 'On-Track in Assessments, On-Track in ELA CG' AND PPPFINAL.MY_LIT_ELA_POST_COMPARE LIKE 'On-Track in Assessments, On-Track in ELA CG' THEN 1 WHEN PPPFINAL.MY_LIT_ELA_PRE_COMPARE LIKE 'On-Track in Assessments, On-Track in ELA CG' AND PPPFINAL.MY_LIT_ELA_POST_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in ELA CG' THEN 3 WHEN PPPFINAL.MY_LIT_ELA_PRE_COMPARE LIKE 'On-Track in Assessments, On-Track in ELA CG' AND PPPFINAL.MY_LIT_ELA_POST_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in ELA CG' THEN 2 ELSE NULL END AS MY_LITON_ELAON_CHANGE_NUM,
CASE WHEN PPPFINAL.MY_LIT_ELA_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in ELA CG' AND PPPFINAL.MY_LIT_ELA_POST_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in ELA CG' THEN 'Remained Off-Track/Sliding in Assessments, Moved Off-Track/Sliding in ELA CG' WHEN PPPFINAL.MY_LIT_ELA_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in ELA CG' AND PPPFINAL.MY_LIT_ELA_POST_COMPARE LIKE 'On-Track in Assessments, On-Track in ELA CG' THEN 'Moved On-Track in Assessments and Remained On-Track in ELA CG' WHEN PPPFINAL.MY_LIT_ELA_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in ELA CG' AND PPPFINAL.MY_LIT_ELA_POST_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in ELA CG' THEN 'Remained Off-Track/Sliding in Assessments, Remained On-Track in ELA CG' WHEN PPPFINAL.MY_LIT_ELA_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in ELA CG' AND PPPFINAL.MY_LIT_ELA_POST_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in ELA CG' THEN 'Moved On-Track in Assessments, Moved Off-Track/Sliding in ELA CG' ELSE NULL END AS MY_LITOFF_ELAON_CHANGE,
CASE WHEN PPPFINAL.MY_LIT_ELA_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in ELA CG' AND PPPFINAL.MY_LIT_ELA_POST_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in ELA CG' THEN 4 WHEN PPPFINAL.MY_LIT_ELA_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in ELA CG' AND PPPFINAL.MY_LIT_ELA_POST_COMPARE LIKE 'On-Track in Assessments, On-Track in ELA CG' THEN 1 WHEN PPPFINAL.MY_LIT_ELA_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in ELA CG' AND PPPFINAL.MY_LIT_ELA_POST_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in ELA CG' THEN 3 WHEN PPPFINAL.MY_LIT_ELA_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in ELA CG' AND PPPFINAL.MY_LIT_ELA_POST_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in ELA CG' THEN 2 ELSE NULL END AS MY_LITOFF_ELAON_CHANGE_NUM,
CASE WHEN PPPFINAL.MY_LIT_ELA_PRE_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in ELA CG' AND PPPFINAL.MY_LIT_ELA_POST_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in ELA CG' THEN 'Moved Off-Track/Sliding in Assessments, Remained Off-Track/Sliding in ELA CG' WHEN PPPFINAL.MY_LIT_ELA_PRE_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in ELA CG' AND PPPFINAL.MY_LIT_ELA_POST_COMPARE LIKE 'On-Track in Assessments, On-Track in ELA CG' THEN 'Remained On-Track in Assessments, Moved On-Track in ELA CG' WHEN PPPFINAL.MY_LIT_ELA_PRE_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in ELA CG' AND PPPFINAL.MY_LIT_ELA_POST_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in ELA CG' THEN 'Moved Off-Track/Sliding in Assessments, Moved On-Track in ELA CG' WHEN PPPFINAL.MY_LIT_ELA_PRE_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in ELA CG' AND PPPFINAL.MY_LIT_ELA_POST_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in ELA CG' THEN 'Remained On-Track in Assessments, Remained Off-Track/Sliding in ELA CG' ELSE NULL END AS MY_LITON_ELAOFF_CHANGE,
CASE WHEN PPPFINAL.MY_LIT_ELA_PRE_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in ELA CG' AND PPPFINAL.MY_LIT_ELA_POST_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in ELA CG' THEN 4 WHEN PPPFINAL.MY_LIT_ELA_PRE_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in ELA CG' AND PPPFINAL.MY_LIT_ELA_POST_COMPARE LIKE 'On-Track in Assessments, On-Track in ELA CG' THEN 1 WHEN PPPFINAL.MY_LIT_ELA_PRE_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in ELA CG' AND PPPFINAL.MY_LIT_ELA_POST_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in ELA CG' THEN 3 WHEN PPPFINAL.MY_LIT_ELA_PRE_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in ELA CG' AND PPPFINAL.MY_LIT_ELA_POST_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in ELA CG' THEN 2 ELSE NULL END AS MY_LITON_ELAOFF_CHANGE_NUM
FROM
(SELECT ppp_LITAssess.SITE_NAME, ppp_LITAssess.SCHOOL_NAME, ppp_LITAssess.GRADE_ID, ppp_LITAssess.DIPLOMAS_NOW_SCHOOL, ppp_LITAssess.STUDENT_ID, ppp_LITAssess.SCHOOL_ID, ppp_LITAssess.TTL_TIME, ppp_LITAssess.ENROLLED_DAYS, ppp_LITAssess.ENROLLED_DAYS_CATEGORIES, ppp_LITAssess.SITE_DOSAGE_GOAL, ppp_LITAssess.STATUS_SITE_DOSAGE_GOAL, ppp_LITAssess.Attendance_IA, ppp_LITAssess.ELA_IA, ppp_LITAssess.Math_IA, ppp_LITAssess.Behavior_IA, ppp_LITAssess.B_RULE_VAL1, ppp_LITAssess.B_RULE_VAL2, ppp_LITAssess.B_RULE_VAL3, ppp_LITAssess.B_RULE_VAL4, ppp_LITAssess.GRADE_ID_RECODE, ppp_LITAssess.DN_SCHOOL_BY_GRADE, ppp_LITAssess.MY_MET_Q3_DOSAGE, ppp_LITAssess.MY_IN_IOG_GRADE_RANGE, ppp_LITAssess.PRE_DATE, ppp_LITAssess.PRE_DESC, ppp_LITAssess.PRE_VALUE_NUM, ppp_LITAssess.PRE_TRACK, ppp_LITAssess.PRE_TRACK_EVAL, ppp_LITAssess.MY_PERF_DATE, ppp_LITAssess.MY_VALUE_NUM, ppp_LITAssess.MY_TRACK, ppp_LITAssess.MY_TRACK_EVAL, ppp_LITAssess.MY_RAWCHANGE_DEGREE, ppp_LITAssess.MY_PERFORMANCECHANGE_LOCAL, ppp_LITAssess.MY_PERFORMANCECHANGE_NORMALIZED, ppp_ELA_CG.PRE_ELA_FREQ, ppp_ELA_CG.PRE_ELA_TRACK, ppp_ELA_CG.PRE_LETTER_VIEW, ppp_ELA_CG.PRE_CG_LETTER_SCALE_ALL, ppp_ELA_CG.MY_ELA_FREQ, ppp_ELA_CG.MY_ELA_TRACK, ppp_ELA_CG.MY_LETTER_VIEW, ppp_ELA_CG.MY_CG_LETTER_SCALE_ALL, ppp_ELA_CG.MY_LETTERGRADE_CHANGE_ACTUAL, ppp_ELA_CG.MY_Change, ppp_ELA_CG.MY_PERF_CHANGE,
CASE WHEN (ppp_LITAssess.PRE_TRACK_EVAL LIKE 'OFF TRACK' OR ppp_LITAssess.PRE_TRACK_EVAL LIKE 'SLIDING') AND (ppp_ELA_CG.PRE_ELA_TRACK LIKE 'OFF TRACK' OR ppp_ELA_CG.PRE_ELA_TRACK LIKE 'SLIDING') THEN 'Off-Track/Sliding in Assessments, Off-Track/Sliding in ELA CG' WHEN (ppp_LITAssess.PRE_TRACK_EVAL LIKE 'OFF TRACK' OR ppp_LITAssess.PRE_TRACK_EVAL LIKE 'SLIDING') AND (ppp_ELA_CG.PRE_ELA_TRACK LIKE 'ON TRACK') THEN 'Off-Track/Sliding in Assessments, On-Track in ELA CG' WHEN (ppp_LITAssess.PRE_TRACK_EVAL LIKE 'ON TRACK') AND (ppp_ELA_CG.PRE_ELA_TRACK LIKE 'OFF TRACK' OR ppp_ELA_CG.PRE_ELA_TRACK LIKE 'SLIDING') THEN 'On-Track in Assessments, Off-Track/Sliding in ELA CG' WHEN (ppp_LITAssess.PRE_TRACK_EVAL LIKE 'ON TRACK') AND (ppp_ELA_CG.PRE_ELA_TRACK LIKE 'ON TRACK') THEN 'On-Track in Assessments, On-Track in ELA CG' ELSE NULL END AS MY_LIT_ELA_PRE_COMPARE,
CASE WHEN (ppp_LITAssess.PRE_TRACK_EVAL LIKE 'OFF TRACK' OR ppp_LITAssess.PRE_TRACK_EVAL LIKE 'SLIDING') AND (ppp_ELA_CG.PRE_ELA_TRACK LIKE 'OFF TRACK' OR ppp_ELA_CG.PRE_ELA_TRACK LIKE 'SLIDING') THEN 4 WHEN (ppp_LITAssess.PRE_TRACK_EVAL LIKE 'OFF TRACK' OR ppp_LITAssess.PRE_TRACK_EVAL LIKE 'SLIDING') AND (ppp_ELA_CG.PRE_ELA_TRACK LIKE 'ON TRACK') THEN 3 WHEN (ppp_LITAssess.PRE_TRACK_EVAL LIKE 'ON TRACK') AND (ppp_ELA_CG.PRE_ELA_TRACK LIKE 'OFF TRACK' OR ppp_ELA_CG.PRE_ELA_TRACK LIKE 'SLIDING') THEN 2 WHEN (ppp_LITAssess.PRE_TRACK_EVAL LIKE 'ON TRACK') AND (ppp_ELA_CG.PRE_ELA_TRACK LIKE 'ON TRACK') THEN 1 ELSE NULL END AS MY_LIT_ELA_PRE_COMPARE_NUM,
CASE WHEN (ppp_LITAssess.MY_TRACK_EVAL LIKE 'OFF TRACK' OR ppp_LITAssess.MY_TRACK_EVAL LIKE 'SLIDING') AND (ppp_ELA_CG.MY_ELA_TRACK LIKE 'OFF TRACK' OR ppp_ELA_CG.MY_ELA_TRACK LIKE 'SLIDING') THEN 'Off-Track/Sliding in Assessments, Off-Track/Sliding in ELA CG' WHEN (ppp_LITAssess.MY_TRACK_EVAL LIKE 'OFF TRACK' OR ppp_LITAssess.MY_TRACK_EVAL LIKE 'SLIDING') AND (ppp_ELA_CG.MY_ELA_TRACK LIKE 'ON TRACK') THEN 'Off-Track/Sliding in Assessments, On-Track in ELA CG' WHEN (ppp_LITAssess.MY_TRACK_EVAL LIKE 'ON TRACK') AND (ppp_ELA_CG.MY_ELA_TRACK LIKE 'OFF TRACK' OR ppp_ELA_CG.MY_ELA_TRACK LIKE 'SLIDING') THEN 'On-Track in Assessments, Off-Track/Sliding in ELA CG' WHEN (ppp_LITAssess.MY_TRACK_EVAL LIKE 'ON TRACK') AND (ppp_ELA_CG.MY_ELA_TRACK LIKE 'ON TRACK') THEN 'On-Track in Assessments, On-Track in ELA CG' ELSE NULL END AS MY_LIT_ELA_POST_COMPARE,
CASE WHEN (ppp_LITAssess.MY_TRACK_EVAL LIKE 'OFF TRACK' OR ppp_LITAssess.MY_TRACK_EVAL LIKE 'SLIDING') AND (ppp_ELA_CG.MY_ELA_TRACK LIKE 'OFF TRACK' OR ppp_ELA_CG.MY_ELA_TRACK LIKE 'SLIDING') THEN 4 WHEN (ppp_LITAssess.MY_TRACK_EVAL LIKE 'OFF TRACK' OR ppp_LITAssess.MY_TRACK_EVAL LIKE 'SLIDING') AND (ppp_ELA_CG.MY_ELA_TRACK LIKE 'ON TRACK') THEN 3 WHEN (ppp_LITAssess.MY_TRACK_EVAL LIKE 'ON TRACK') AND (ppp_ELA_CG.MY_ELA_TRACK LIKE 'OFF TRACK' OR ppp_ELA_CG.MY_ELA_TRACK LIKE 'SLIDING') THEN 2 WHEN (ppp_LITAssess.MY_TRACK_EVAL LIKE 'ON TRACK') AND (ppp_ELA_CG.MY_ELA_TRACK LIKE 'ON TRACK') THEN 1 ELSE NULL END AS MY_LIT_ELA_POST_COMPARE_NUM
FROM
(SELECT LIT.*,
CASE WHEN (PRE_VALUE_NUM IS NOT NULL AND MY_VALUE_NUM IS NOT NULL) AND PRE_VALUE_NUM < MY_VALUE_NUM THEN 'Increase' WHEN (PRE_VALUE_NUM IS NOT NULL AND MY_VALUE_NUM IS NOT NULL) AND PRE_VALUE_NUM = MY_VALUE_NUM THEN 'No Change' WHEN (PRE_VALUE_NUM IS NOT NULL AND MY_VALUE_NUM IS NOT NULL) AND PRE_VALUE_NUM > MY_VALUE_NUM THEN 'Decrease' ELSE 'Insufficient Data' END AS MY_RAWCHANGE_DEGREE,
CASE WHEN (PRE_TRACK IS NOT NULL AND MY_TRACK IS NOT NULL) THEN PRE_TRACK + ' to ' + MY_TRACK ELSE 'Insufficient Data' END AS MY_PERFORMANCECHANGE_LOCAL,
CASE WHEN (PRE_TRACK_EVAL IS NOT NULL AND MY_TRACK_EVAL IS NOT NULL) THEN PRE_TRACK_EVAL + ' to ' + MY_TRACK_EVAL ELSE 'Insufficient Data' END AS MY_PERFORMANCECHANGE_NORMALIZED,
CASE WHEN ((SCHOOL_ID = 2848 Or SCHOOL_ID = 2988) And GRADE_ID_RECODE < 9) Or (SCHOOL_ID = 3010 And GRADE_ID_RECODE > 9) THEN '0' ELSE DIPLOMAS_NOW_SCHOOL END AS DN_SCHOOL_BY_GRADE,
CASE WHEN GRADE_ID_RECODE >= B_RULE_VAL3 AND GRADE_ID_RECODE <= B_RULE_VAL4 THEN 1 WHEN GRADE_ID_RECODE < B_RULE_VAL3 OR GRADE_ID_RECODE > B_RULE_VAL4 THEN 0 ELSE NULL END AS MY_IN_IOG_GRADE_RANGE
FROM
(SELECT dbo.RPT_STUDENT_MAIN.SITE_NAME, dbo.RPT_STUDENT_MAIN.SCHOOL_NAME, dbo.RPT_STUDENT_MAIN.GRADE_ID, dbo.RPT_STUDENT_MAIN.DIPLOMAS_NOW_SCHOOL, dbo.RPT_STUDENT_MAIN.STUDENT_ID, dbo.RPT_STUDENT_MAIN.SCHOOL_ID, prepost.ASSESSMENT_TYPE, prepost.PRE_VALUE, prepost.PRE_VALUE_DISPLAY, prepost.PRE_VALUE_NUM, prepost.PRE_DATE, prepost.PRE_DESC, prepost.PRE_TRACK, prepost.PRE_TRACK_EVAL, prepost.PRE_TRACK_NATIONAL, prepost.POST_VALUE, prepost.POST_VALUE_DISPLAY, prepost.POST_VALUE_NUM, prepost.POST_DATE, prepost.POST_DESC, prepost.POST_TRACK, prepost.POST_TRACK_EVAL, prepost.POST_TRACK_NATIONAL, prepost.DOSAGE_CATEGORY, prepost.TTL_TIME, prepost.ENROLLED_DAYS_CATEGORIES, prepost.CURRENTLY_ENROLLED, prepost.ENROLLED_DAYS, prepost.LIT_ASSESS_RAWCHANGE, prepost.LIT_ASSESS_RAWCHANGE_DEGREE, prepost.LIT_ASSESS_PERFORMANCECHANGE_LOCAL, prepost.LIT_ASSESS_PERFORMANCECHANGE_NORMALIZED, prepost.LIT_ASSESS_PERCENTCHANGE, prepost.STATUS_SITE_DOSAGE_GOAL, prepost.SITE_DOSAGE_GOAL, prepost.Attendance_IA, prepost.ELA_IA, prepost.Math_IA, prepost.Behavior_IA, MY_PROXY_LITAssess.CONFIG_ID, MY_PROXY_LITAssess.FREQUENCY_PERIOD_ID, MY_PROXY_LITAssess.SKILL_ID, MY_PROXY_LITAssess.SKILL_DESCRIPTION, MY_PROXY_LITAssess.INTERVAL, MY_PROXY_LITAssess.INDICATOR_DESC, MY_PROXY_LITAssess.FREQ_SORT, MY_PROXY_LITAssess.STUDENT_NAME, MY_PROXY_LITAssess.SITE_ID, MY_PROXY_LITAssess.PERF_DATE, MY_PROXY_LITAssess.PERFORMANCE_VALUE, MY_PROXY_LITAssess.PERFORMANCE_VALUE_NUMERIC, MY_PROXY_LITAssess.SCALE_LOCAL, MY_PROXY_LITAssess.SCALE_EVAL, MY_PROXY_LITAssess.SCALE_TYPE, MY_PROXY_LITAssess.PERF_DIRECTION, MY_PROXY_LITAssess.PROC_TYPE, MY_PROXY_LITAssess.PERF_RUN_DATE, MY_PROXY_LITAssess.INDICATOR_AREA_ID, MY_PROXY_LITAssess.CONFIG_NAME, MY_PROXY_LITAssess.PRIMARY_CM, MY_PROXY_LITAssess.INTERVENTION_TIME, MY_PROXY_LITAssess.DATA_POINT, MY_PROXY_LITAssess.CG_VALUE_DISPLAY, MY_PROXY_LITAssess.CG_VALUE_NUM, MY_PROXY_LITAssess.CG_LETTER_VIEW, MY_PROXY_LITAssess.CG_LETTER_VIEW_ALL, MY_PROXY_LITAssess.Tag, dbo.RPT_SCHOOL_GRADE.INDICATOR_ID, dbo.RPT_SCHOOL_GRADE.B_RULE_VAL1, dbo.RPT_SCHOOL_GRADE.B_RULE_VAL2, dbo.RPT_SCHOOL_GRADE.B_RULE_VAL3, dbo.RPT_SCHOOL_GRADE.B_RULE_VAL4, dbo.RPT_SCHOOL_GRADE.B_RULE_VAL5,
CASE WHEN prepost.POST_DATE IS NULL AND prepost.PRE_DATE < MY_PROXY_LITAssess.PERF_DATE AND prepost.PRE_DESC LIKE MY_PROXY_LITAssess.SKILL_DESCRIPTION THEN MY_PROXY_LITAssess.PERF_DATE ELSE prepost.POST_DATE END AS MY_PERF_DATE,
CASE WHEN prepost.POST_DATE IS NULL AND prepost.PRE_DATE < MY_PROXY_LITAssess.PERF_DATE AND prepost.PRE_DESC LIKE MY_PROXY_LITAssess.SKILL_DESCRIPTION THEN MY_PROXY_LITAssess.SKILL_DESCRIPTION ELSE prepost.POST_DESC END AS MY_DESC,
CASE WHEN prepost.POST_DATE IS NULL AND prepost.PRE_DATE < MY_PROXY_LITAssess.PERF_DATE AND prepost.PRE_DESC LIKE MY_PROXY_LITAssess.SKILL_DESCRIPTION THEN MY_PROXY_LITAssess.PERFORMANCE_VALUE_NUMERIC ELSE prepost.POST_VALUE_NUM END AS MY_VALUE_NUM,
CASE WHEN prepost.POST_DATE IS NULL AND prepost.PRE_DATE < MY_PROXY_LITAssess.PERF_DATE AND prepost.PRE_DESC LIKE MY_PROXY_LITAssess.SKILL_DESCRIPTION THEN MY_PROXY_LITAssess.SCALE_LOCAL ELSE prepost.POST_TRACK END AS MY_TRACK,
CASE WHEN prepost.POST_DATE IS NULL AND prepost.PRE_DATE < MY_PROXY_LITAssess.PERF_DATE AND prepost.PRE_DESC LIKE MY_PROXY_LITAssess.SKILL_DESCRIPTION THEN MY_PROXY_LITAssess.SCALE_EVAL ELSE prepost.POST_TRACK_EVAL END AS MY_TRACK_EVAL,
CASE WHEN dbo.RPT_STUDENT_MAIN.GRADE_ID = 21 THEN -1 WHEN dbo.RPT_STUDENT_MAIN.GRADE_ID = 22 THEN 0 ELSE dbo.RPT_STUDENT_MAIN.GRADE_ID END AS GRADE_ID_RECODE,
CASE WHEN prepost.TTL_TIME >= dbo.RPT_SCHOOL_GRADE.B_RULE_VAL2 THEN 1 WHEN prepost.TTL_TIME < dbo.RPT_SCHOOL_GRADE.B_RULE_VAL2 THEN 0 ELSE NULL END AS MY_MET_Q3_DOSAGE
FROM dbo.RPT_SCHOOL_GRADE INNER JOIN (dbo.RPT_STUDENT_MAIN INNER JOIN (dbo.EVAL_ASSESSMENT AS prepost LEFT OUTER JOIN
(SELECT allLIT1.CONFIG_ID, allLIT1.STUDENT_ID, allLIT1.FREQUENCY_PERIOD_ID, allLIT1.SKILL_ID, allLIT1.SKILL_DESCRIPTION, allLIT1.INTERVAL, allLIT1.INDICATOR_DESC, allLIT1.FREQ_SORT, allLIT1.SCHOOL_NAME, allLIT1.SITE_NAME, allLIT1.STUDENT_NAME, allLIT1.SCHOOL_ID, allLIT1.SITE_ID, allLIT1.PERF_DATE, allLIT1.PERFORMANCE_VALUE, allLIT1.PERFORMANCE_VALUE_NUMERIC, allLIT1.SCALE_LOCAL, allLIT1.SCALE_EVAL, allLIT1.SCALE_TYPE, allLIT1.PERF_DIRECTION, allLIT1.PROC_TYPE, allLIT1.PERF_RUN_DATE, allLIT1.INDICATOR_AREA_ID, allLIT1.CONFIG_NAME, allLIT1.PRIMARY_CM, allLIT1.INTERVENTION_TIME, allLIT1.DATA_POINT, allLIT1.CG_VALUE_DISPLAY, allLIT1.CG_VALUE_NUM, allLIT1.CG_LETTER_VIEW, allLIT1.CG_LETTER_VIEW_ALL, allLIT1.Tag
FROM dbo.RPT_PERFORMANCE_LEVEL AS allLIT1 LEFT OUTER JOIN dbo.RPT_PERFORMANCE_LEVEL AS allLIT2
ON (allLIT1.STUDENT_ID = allLIT2.STUDENT_ID AND allLIT1.INDICATOR_DESC LIKE allLIT2.INDICATOR_DESC AND allLIT1.PERF_DATE < allLIT2.PERF_DATE)
WHERE allLIT2.STUDENT_ID IS NULL AND allLIT1.CONFIG_NAME LIKE 'ELA/Lit Assessment%' AND allLIT1.Tag IS NULL)
AS MY_PROXY_LITAssess ON prepost.STUDENT_ID = MY_PROXY_LITAssess.STUDENT_ID) ON (dbo.RPT_STUDENT_MAIN.STUDENT_ID = prepost.STUDENT_ID)) ON (dbo.RPT_SCHOOL_GRADE.SCHOOL_ID = prepost.SCHOOL_ID AND dbo.RPT_SCHOOL_GRADE.INDICATOR_ID = 3)
WHERE dbo.RPT_SCHOOL_GRADE.GRADE_ID = dbo.RPT_STUDENT_MAIN.GRADE_ID AND prepost.ASSESSMENT_TYPE LIKE 'LITERACY')
AS LIT)
AS ppp_LITAssess INNER JOIN
(SELECT ELACGFINAL.*, letterchange.LetterGradeChange_general AS MY_Change
FROM
(SELECT ELACG.*,
CASE WHEN ELACG.PRE_LETTER_VIEW IS NOT NULL AND ELACG.MY_LETTER_VIEW IS NOT NULL THEN ELACG.PRE_LETTER_VIEW + ' to ' + ELACG.MY_LETTER_VIEW ELSE NULL END AS MY_LETTERGRADE_CHANGE_ACTUAL,
CASE WHEN ELACG.PRE_ELA_TRACK IS NOT NULL AND ELACG.MY_ELA_TRACK IS NOT NULL THEN ELACG.PRE_ELA_TRACK + ' to ' + ELACG.MY_ELA_TRACK ELSE NULL END AS MY_PERF_CHANGE,
CASE WHEN ((ELACG.SCHOOL_ID = 2848 Or ELACG.SCHOOL_ID = 2988) And ELACG.GRADE_ID_RECODE < 9) Or (ELACG.SCHOOL_ID = 3010 And ELACG.GRADE_ID_RECODE > 9) THEN '0' ELSE ELACG.DIPLOMAS_NOW_SCHOOL END AS DN_SCHOOL_BY_GRADE,
CASE WHEN ELACG.GRADE_ID_RECODE >= ELACG.B_RULE_VAL3 AND ELACG.GRADE_ID_RECODE <= ELACG.B_RULE_VAL4 THEN 1 WHEN ELACG.GRADE_ID_RECODE < ELACG.B_RULE_VAL3 OR ELACG.GRADE_ID_RECODE > ELACG.B_RULE_VAL4 THEN 0 ELSE NULL END AS MY_IN_IOG_GRADE_RANGE
FROM
(SELECT dbo.RPT_STUDENT_MAIN.SITE_NAME, dbo.RPT_STUDENT_MAIN.SCHOOL_NAME, dbo.RPT_STUDENT_MAIN.GRADE_ID, dbo.RPT_STUDENT_MAIN.DIPLOMAS_NOW_SCHOOL, dbo.RPT_STUDENT_MAIN.STUDENT_ID, dbo.RPT_STUDENT_MAIN.SCHOOL_ID, prepost.PRE_ELA_CG_VALUE, prepost.PRE_ELA_CG_VALUE_DISPLAY, prepost.PRE_ELA_CG_VALUE_NUM, prepost.PRE_ELA_DESC, prepost.PRE_ELA_FREQ, prepost.PRE_ELA_TRACK, prepost.PRE_ELA_TRACK_EVAL, prepost.PRE_SCENARIO, prepost.PRE_LETTER_VIEW, prepost.PRE_CG_LETTER_SCALE_ALL, prepost.DOSAGE_CATEGORY, prepost.TTL_TIME, prepost.POST_ELA_CG_VALUE, prepost.POST_ELA_CG_VALUE_DISPLAY, prepost.POST_ELA_CG_VALUE_NUM, prepost.POST_ELA_DESC, prepost.POST_ELA_FREQ, prepost.POST_ELA_TRACK, prepost.POST_ELA_TRACK_EVAL, prepost.POST_SCENARIO, prepost.POST_LETTER_VIEW, prepost.POST_CG_LETTER_SCALE_ALL, prepost.LETTERGADE_CHANGE_ACTUAL, prepost.LETTERGADE_CHANGE_GENERAL, prepost.CG_Performance_Level_Change, prepost.CG_Change, prepost.Enrollment_Duration, prepost.ENROLL_DAYS, prepost.STATUS_SITE_DOSAGE_GOAL, prepost.SITE_DOSAGE_GOAL, prepost.Attendance_IA, prepost.ELA_IA, prepost.Math_IA, prepost.Behavior_IA, MY_PROXY_ELA_CG.CONFIG_ID, MY_PROXY_ELA_CG.FREQUENCY_PERIOD_ID, MY_PROXY_ELA_CG.SKILL_ID, MY_PROXY_ELA_CG.SKILL_DESCRIPTION, MY_PROXY_ELA_CG.INTERVAL, MY_PROXY_ELA_CG.INDICATOR_DESC, MY_PROXY_ELA_CG.FREQ_SORT, MY_PROXY_ELA_CG.STUDENT_NAME, MY_PROXY_ELA_CG.SITE_ID, MY_PROXY_ELA_CG.PERF_DATE, MY_PROXY_ELA_CG.PERFORMANCE_VALUE, MY_PROXY_ELA_CG.PERFORMANCE_VALUE_NUMERIC, MY_PROXY_ELA_CG.SCALE_LOCAL, MY_PROXY_ELA_CG.SCALE_EVAL, MY_PROXY_ELA_CG.SCALE_TYPE, MY_PROXY_ELA_CG.PERF_DIRECTION, MY_PROXY_ELA_CG.PROC_TYPE, MY_PROXY_ELA_CG.PERF_RUN_DATE, MY_PROXY_ELA_CG.INDICATOR_AREA_ID, MY_PROXY_ELA_CG.CONFIG_NAME, MY_PROXY_ELA_CG.PRIMARY_CM, MY_PROXY_ELA_CG.INTERVENTION_TIME, MY_PROXY_ELA_CG.DATA_POINT, MY_PROXY_ELA_CG.CG_VALUE_DISPLAY, MY_PROXY_ELA_CG.CG_VALUE_NUM, MY_PROXY_ELA_CG.CG_LETTER_VIEW, MY_PROXY_ELA_CG.CG_LETTER_VIEW_ALL, MY_PROXY_ELA_CG.Tag, dbo.RPT_SCHOOL_GRADE.INDICATOR_ID, dbo.RPT_SCHOOL_GRADE.B_RULE_VAL1, dbo.RPT_SCHOOL_GRADE.B_RULE_VAL2, dbo.RPT_SCHOOL_GRADE.B_RULE_VAL3, dbo.RPT_SCHOOL_GRADE.B_RULE_VAL4, dbo.RPT_SCHOOL_GRADE.B_RULE_VAL5,
CASE WHEN prepost.POST_ELA_FREQ IS NULL AND (prepost.PRE_ELA_FREQ < MY_PROXY_ELA_CG.INTERVAL OR prepost.PRE_ELA_FREQ LIKE 'ELA/Literacy PrYr/Cumulative') THEN MY_PROXY_ELA_CG.INTERVAL ELSE prepost.POST_ELA_FREQ END AS MY_ELA_FREQ,
CASE WHEN prepost.POST_ELA_FREQ IS NULL AND (prepost.PRE_ELA_FREQ < MY_PROXY_ELA_CG.INTERVAL OR prepost.PRE_ELA_FREQ LIKE 'ELA/Literacy PrYr/Cumulative') THEN MY_PROXY_ELA_CG.SCALE_LOCAL ELSE prepost.POST_ELA_TRACK END AS MY_ELA_TRACK,
CASE WHEN prepost.POST_ELA_FREQ IS NULL AND (prepost.PRE_ELA_FREQ < MY_PROXY_ELA_CG.INTERVAL OR prepost.PRE_ELA_FREQ LIKE 'ELA/Literacy PrYr/Cumulative') THEN MY_PROXY_ELA_CG.CG_LETTER_VIEW ELSE prepost.POST_LETTER_VIEW END AS MY_LETTER_VIEW,
CASE WHEN prepost.POST_ELA_FREQ IS NULL AND (prepost.PRE_ELA_FREQ < MY_PROXY_ELA_CG.INTERVAL OR prepost.PRE_ELA_FREQ LIKE 'ELA/Literacy PrYr/Cumulative') THEN MY_PROXY_ELA_CG.CG_LETTER_VIEW_ALL ELSE prepost.POST_CG_LETTER_SCALE_ALL END AS MY_CG_LETTER_SCALE_ALL,
CASE WHEN dbo.RPT_STUDENT_MAIN.GRADE_ID = 21 THEN -1 WHEN dbo.RPT_STUDENT_MAIN.GRADE_ID = 22 THEN 0 ELSE dbo.RPT_STUDENT_MAIN.GRADE_ID END AS GRADE_ID_RECODE,
CASE WHEN prepost.TTL_TIME >= dbo.RPT_SCHOOL_GRADE.B_RULE_VAL2 THEN 1 WHEN prepost.TTL_TIME < dbo.RPT_SCHOOL_GRADE.B_RULE_VAL2 THEN 0 ELSE NULL END AS MY_MET_Q3_DOSAGE
FROM dbo.RPT_SCHOOL_GRADE INNER JOIN (dbo.RPT_STUDENT_MAIN INNER JOIN (dbo.EVAL_ELA AS prepost LEFT OUTER JOIN
(SELECT allELA1.CONFIG_ID, allELA1.STUDENT_ID, allELA1.FREQUENCY_PERIOD_ID, allELA1.SKILL_ID, allELA1.SKILL_DESCRIPTION, allELA1.INTERVAL, allELA1.INDICATOR_DESC, allELA1.FREQ_SORT, allELA1.SCHOOL_NAME, allELA1.SITE_NAME, allELA1.STUDENT_NAME, allELA1.SCHOOL_ID, allELA1.SITE_ID, allELA1.PERF_DATE, allELA1.PERFORMANCE_VALUE, allELA1.PERFORMANCE_VALUE_NUMERIC, allELA1.SCALE_LOCAL, allELA1.SCALE_EVAL, allELA1.SCALE_TYPE, allELA1.PERF_DIRECTION, allELA1.PROC_TYPE, allELA1.PERF_RUN_DATE, allELA1.INDICATOR_AREA_ID, allELA1.CONFIG_NAME, allELA1.PRIMARY_CM, allELA1.INTERVENTION_TIME, allELA1.DATA_POINT, allELA1.CG_VALUE_DISPLAY, allELA1.CG_VALUE_NUM, allELA1.CG_LETTER_VIEW, allELA1.CG_LETTER_VIEW_ALL, allELA1.Tag
FROM dbo.RPT_PERFORMANCE_LEVEL AS allELA1 LEFT OUTER JOIN dbo.RPT_PERFORMANCE_LEVEL AS allELA2 ON (allELA1.STUDENT_ID = allELA2.STUDENT_ID AND allELA1.INDICATOR_DESC LIKE allELA2.INDICATOR_DESC AND allELA1.FREQ_SORT < allELA2.FREQ_SORT)
WHERE allELA2.STUDENT_ID IS NULL AND allELA1.SKILL_DESCRIPTION LIKE 'ELA Course Grade' AND allELA1.Tag IS NULL)
AS MY_PROXY_ELA_CG ON (prepost.STUDENT_ID = MY_PROXY_ELA_CG.STUDENT_ID)) ON (dbo.RPT_STUDENT_MAIN.STUDENT_ID = prepost.STUDENT_ID)) ON (dbo.RPT_SCHOOL_GRADE.SCHOOL_ID = prepost.SCHOOL_ID AND dbo.RPT_SCHOOL_GRADE.INDICATOR_ID = 3)
WHERE dbo.RPT_SCHOOL_GRADE.GRADE_ID = dbo.RPT_STUDENT_MAIN.GRADE_ID)
AS ELACG)
AS ELACGFINAL LEFT OUTER JOIN dbo.RPT_LETTER_CHANGE_DEGREE AS letterchange
ON (ELACGFINAL.MY_LETTERGRADE_CHANGE_ACTUAL LIKE letterchange.LetterGrade_Change_Actual))
AS ppp_ELA_CG
ON ppp_LITAssess.STUDENT_ID = ppp_ELA_CG.STUDENT_ID)
AS PPPFINAL
ORDER BY SITE_NAME, SCHOOL_NAME, GRADE_ID, STUDENT_ID;