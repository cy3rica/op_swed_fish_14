-- These queries set up data for end-of-year student performance data reporting.
-- HAVEN'T TESTED THIS YET.

-- QUERY SYNTAX (BASED ON ELA CG/LIT ASSESS QUERIES -- STEP 1):

SELECT prepost_LIT.SITE_NAME, prepost_LIT.SCHOOL_NAME, prepost_LIT.GRADE_ID, prepost_LIT.DIPLOMAS_NOW_SCHOOL, prepost_LIT.STUDENT_ID, prepost_LIT.SCHOOL_ID, prepost_LIT.ASSESSMENT_TYPE, prepost_LIT.PRE_VALUE, prepost_LIT.PRE_VALUE_DISPLAY, prepost_LIT.PRE_VALUE_NUM, prepost_LIT.PRE_DATE, prepost_LIT.PRE_DESC, prepost_LIT.PRE_TRACK, prepost_LIT.PRE_TRACK_EVAL, prepost_LIT.PRE_TRACK_NATIONAL, prepost_LIT.POST_VALUE, prepost_LIT.POST_VALUE_DISPLAY, prepost_LIT.POST_VALUE_NUM, prepost_LIT.POST_DATE, prepost_LIT.POST_DESC, prepost_LIT.POST_TRACK, prepost_LIT.POST_TRACK_EVAL, prepost_LIT.POST_TRACK_NATIONAL, prepost_LIT.DOSAGE_CATEGORY, prepost_LIT.TTL_TIME, prepost_LIT.ENROLLED_DAYS_CATEGORIES, prepost_LIT.CURRENTLY_ENROLLED, prepost_LIT.ENROLLED_DAYS, prepost_LIT.LIT_ASSESS_RAWCHANGE, prepost_LIT.LIT_ASSESS_RAWCHANGE_DEGREE, prepost_LIT.LIT_ASSESS_PERFORMANCECHANGE_LOCAL, prepost_LIT.LIT_ASSESS_PERFORMANCECHANGE_NORMALIZED, prepost_LIT.LIT_ASSESS_PERCENTCHANGE, prepost_LIT.STATUS_SITE_DOSAGE_GOAL, prepost_LIT.SITE_DOSAGE_GOAL, prepost_LIT.Attendance_IA, prepost_LIT.ELA_IA, prepost_LIT.Math_IA, prepost_LIT.Behavior_IA, prepost_LIT.INDICATOR_ID, prepost_LIT.B_RULE_VAL1, prepost_LIT.B_RULE_VAL2, prepost_LIT.B_RULE_VAL3, prepost_LIT.B_RULE_VAL4, prepost_LIT.B_RULE_VAL5, prepost_LIT.GRADE_ID_RECODE, prepost_LIT.EOY_MET_Q3_DOSAGE, prepost_LIT.DN_SCHOOL_BY_GRADE, prepost_LIT.EOY_IN_IOG_GRADE_RANGE, prepost_ELACG.PRE_ELA_CG_VALUE, prepost_ELACG.PRE_ELA_CG_VALUE_DISPLAY, prepost_ELACG.PRE_ELA_CG_VALUE_NUM, prepost_ELACG.PRE_ELA_DESC, prepost_ELACG.PRE_ELA_FREQ, prepost_ELACG.PRE_ELA_TRACK, prepost_ELACG.PRE_ELA_TRACK_EVAL, prepost_ELACG.PRE_SCENARIO, prepost_ELACG.PRE_LETTER_VIEW, prepost_ELACG.PRE_CG_LETTER_SCALE_ALL, prepost_ELACG.POST_ELA_CG_VALUE, prepost_ELACG.POST_ELA_CG_VALUE_DISPLAY, prepost_ELACG.POST_ELA_CG_VALUE_NUM, prepost_ELACG.POST_ELA_DESC, prepost_ELACG.POST_ELA_FREQ, prepost_ELACG.POST_ELA_TRACK, prepost_ELACG.POST_ELA_TRACK_EVAL, prepost_ELACG.POST_SCENARIO, prepost_ELACG.POST_LETTER_VIEW, prepost_ELACG.POST_CG_LETTER_SCALE_ALL, prepost_ELACG.LETTERGADE_CHANGE_ACTUAL, prepost_ELACG.LETTERGADE_CHANGE_GENERAL, prepost_ELACG.CG_Performance_Level_Change, prepost_ELACG.CG_Change, prepost_ELACG.Enrollment_Duration, prepost_ELACG.ENROLL_DAYS,
CASE WHEN (prepost_LIT.PRE_TRACK_EVAL LIKE 'OFF TRACK' OR prepost_LIT.PRE_TRACK_EVAL LIKE 'SLIDING') AND (prepost_ELACG.PRE_ELA_TRACK LIKE 'OFF TRACK' OR prepost_ELACG.PRE_ELA_TRACK LIKE 'SLIDING') THEN 'Off-Track/Sliding in Assessments, Off-Track/Sliding in ELA CG' WHEN (prepost_LIT.PRE_TRACK_EVAL LIKE 'OFF TRACK' OR prepost_LIT.PRE_TRACK_EVAL LIKE 'SLIDING') AND (prepost_ELACG.PRE_ELA_TRACK LIKE 'ON TRACK') THEN 'Off-Track/Sliding in Assessments, On-Track in ELA CG' WHEN (prepost_LIT.PRE_TRACK_EVAL LIKE 'ON TRACK') AND (prepost_ELACG.PRE_ELA_TRACK LIKE 'OFF TRACK' OR prepost_ELACG.PRE_ELA_TRACK LIKE 'SLIDING') THEN 'On-Track in Assessments, Off-Track/Sliding in ELA CG' WHEN (prepost_LIT.PRE_TRACK_EVAL LIKE 'ON TRACK') AND (prepost_ELACG.PRE_ELA_TRACK LIKE 'ON TRACK') THEN 'On-Track in Assessments, On-Track in ELA CG' ELSE NULL END AS EOY_LIT_ELA_PRE_COMPARE,
CASE WHEN (prepost_LIT.PRE_TRACK_EVAL LIKE 'OFF TRACK' OR prepost_LIT.PRE_TRACK_EVAL LIKE 'SLIDING') AND (prepost_ELACG.PRE_ELA_TRACK LIKE 'OFF TRACK' OR prepost_ELACG.PRE_ELA_TRACK LIKE 'SLIDING') THEN 4 WHEN (prepost_LIT.PRE_TRACK_EVAL LIKE 'OFF TRACK' OR prepost_LIT.PRE_TRACK_EVAL LIKE 'SLIDING') AND (prepost_ELACG.PRE_ELA_TRACK LIKE 'ON TRACK') THEN 3 WHEN (prepost_LIT.PRE_TRACK_EVAL LIKE 'ON TRACK') AND (prepost_ELACG.PRE_ELA_TRACK LIKE 'OFF TRACK' OR prepost_ELACG.PRE_ELA_TRACK LIKE 'SLIDING') THEN 2 WHEN (prepost_LIT.PRE_TRACK_EVAL LIKE 'ON TRACK') AND (prepost_ELACG.PRE_ELA_TRACK LIKE 'ON TRACK') THEN 1 ELSE NULL END AS EOY_LIT_ELA_PRE_COMPARE_NUM,
CASE WHEN (prepost_LIT.POST_TRACK_EVAL LIKE 'OFF TRACK' OR prepost_LIT.POST_TRACK_EVAL LIKE 'SLIDING') AND (prepost_ELACG.POST_ELA_TRACK LIKE 'OFF TRACK' OR prepost_ELACG.POST_ELA_TRACK LIKE 'SLIDING') THEN 'Off-Track/Sliding in Assessments, Off-Track/Sliding in ELA CG' WHEN (prepost_LIT.POST_TRACK_EVAL LIKE 'OFF TRACK' OR prepost_LIT.POST_TRACK_EVAL LIKE 'SLIDING') AND (prepost_ELACG.POST_ELA_TRACK LIKE 'ON TRACK') THEN 'Off-Track/Sliding in Assessments, On-Track in ELA CG' WHEN (prepost_LIT.POST_TRACK_EVAL LIKE 'ON TRACK') AND (prepost_ELACG.POST_ELA_TRACK LIKE 'OFF TRACK' OR prepost_ELACG.POST_ELA_TRACK LIKE 'SLIDING') THEN 'On-Track in Assessments, Off-Track/Sliding in ELA CG' WHEN (prepost_LIT.POST_TRACK_EVAL LIKE 'ON TRACK') AND (prepost_ELACG.POST_ELA_TRACK LIKE 'ON TRACK') THEN 'On-Track in Assessments, On-Track in ELA CG' ELSE NULL END AS EOY_LIT_ELA_POST_COMPARE,
CASE WHEN (prepost_LIT.POST_TRACK_EVAL LIKE 'OFF TRACK' OR prepost_LIT.POST_TRACK_EVAL LIKE 'SLIDING') AND (prepost_ELACG.POST_ELA_TRACK LIKE 'OFF TRACK' OR prepost_ELACG.POST_ELA_TRACK LIKE 'SLIDING') THEN 4 WHEN (prepost_LIT.POST_TRACK_EVAL LIKE 'OFF TRACK' OR prepost_LIT.POST_TRACK_EVAL LIKE 'SLIDING') AND (prepost_ELACG.POST_ELA_TRACK LIKE 'ON TRACK') THEN 3 WHEN (prepost_LIT.POST_TRACK_EVAL LIKE 'ON TRACK') AND (prepost_ELACG.POST_ELA_TRACK LIKE 'OFF TRACK' OR prepost_ELACG.POST_ELA_TRACK LIKE 'SLIDING') THEN 2 WHEN (prepost_LIT.POST_TRACK_EVAL LIKE 'ON TRACK') AND (prepost_ELACG.POST_ELA_TRACK LIKE 'ON TRACK') THEN 1 ELSE NULL END AS EOY_LIT_ELA_POST_COMPARE_NUM
FROM
(*****LIT QUERY*****)
AS prepost_LIT INNER JOIN
(*****ELA CG QUERY*****)
AS prepost_ELACG
ON prepost_LIT.STUDENT_ID = prepost_ELACG.STUDENT_ID;

-- QUERY SYNTAX (BASED ON ABOVE QUERY -- STEP 2 -- this extra step is required since calculations/joins on new variables can't reference variables that were just created in the same query):

DROP TABLE ImpactAnalytics.dbo.FY14_EOY_LIT_ASSESS_ELA_CG
SELECT PPPFINAL.*,
CASE WHEN PPPFINAL.EOY_LIT_ELA_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in ELA CG' AND PPPFINAL.EOY_LIT_ELA_POST_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in ELA CG' THEN 'Remained Off-Track/Sliding in Assessments and ELA CG' WHEN PPPFINAL.EOY_LIT_ELA_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in ELA CG' AND PPPFINAL.EOY_LIT_ELA_POST_COMPARE LIKE 'On-Track in Assessments, On-Track in ELA CG' THEN 'Moved On-Track in Both Assessments and ELA CG' WHEN PPPFINAL.EOY_LIT_ELA_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in ELA CG' AND PPPFINAL.EOY_LIT_ELA_POST_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in ELA CG' THEN 'Remained Off-Track/Sliding in Assessments, Moved On-Track in ELA CG' WHEN PPPFINAL.EOY_LIT_ELA_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in ELA CG' AND PPPFINAL.EOY_LIT_ELA_POST_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in ELA CG' THEN 'Moved On-Track in Assessments, Remained Off-Track/Sliding in ELA CG' ELSE NULL END AS EOY_LITOFF_ELAOFF_CHANGE,
CASE WHEN PPPFINAL.EOY_LIT_ELA_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in ELA CG' AND PPPFINAL.EOY_LIT_ELA_POST_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in ELA CG' THEN 4 WHEN PPPFINAL.EOY_LIT_ELA_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in ELA CG' AND PPPFINAL.EOY_LIT_ELA_POST_COMPARE LIKE 'On-Track in Assessments, On-Track in ELA CG' THEN 1 WHEN PPPFINAL.EOY_LIT_ELA_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in ELA CG' AND PPPFINAL.EOY_LIT_ELA_POST_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in ELA CG' THEN 3 WHEN PPPFINAL.EOY_LIT_ELA_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in ELA CG' AND PPPFINAL.EOY_LIT_ELA_POST_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in ELA CG' THEN 2 ELSE NULL END AS EOY_LITOFF_ELAOFF_CHANGE_NUM,
CASE WHEN PPPFINAL.EOY_LIT_ELA_PRE_COMPARE LIKE 'On-Track in Assessments, On-Track in ELA CG' AND PPPFINAL.EOY_LIT_ELA_POST_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in ELA CG' THEN 'Moved Off-Track/Sliding in Both Assessments and ELA CG' WHEN PPPFINAL.EOY_LIT_ELA_PRE_COMPARE LIKE 'On-Track in Assessments, On-Track in ELA CG' AND PPPFINAL.EOY_LIT_ELA_POST_COMPARE LIKE 'On-Track in Assessments, On-Track in ELA CG' THEN 'Remained On-Track in Assessments and ELA CG' WHEN PPPFINAL.EOY_LIT_ELA_PRE_COMPARE LIKE 'On-Track in Assessments, On-Track in ELA CG' AND PPPFINAL.EOY_LIT_ELA_POST_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in ELA CG' THEN 'Moved Off-Track/Sliding in Assessments, Remained On-Track in ELA CG' WHEN PPPFINAL.EOY_LIT_ELA_PRE_COMPARE LIKE 'On-Track in Assessments, On-Track in ELA CG' AND PPPFINAL.EOY_LIT_ELA_POST_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in ELA CG' THEN 'Remained On-Track in Assessments, Moved Off-Track/Sliding in ELA CG' ELSE NULL END AS EOY_LITON_ELAON_CHANGE,
CASE WHEN PPPFINAL.EOY_LIT_ELA_PRE_COMPARE LIKE 'On-Track in Assessments, On-Track in ELA CG' AND PPPFINAL.EOY_LIT_ELA_POST_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in ELA CG' THEN 4 WHEN PPPFINAL.EOY_LIT_ELA_PRE_COMPARE LIKE 'On-Track in Assessments, On-Track in ELA CG' AND PPPFINAL.EOY_LIT_ELA_POST_COMPARE LIKE 'On-Track in Assessments, On-Track in ELA CG' THEN 1 WHEN PPPFINAL.EOY_LIT_ELA_PRE_COMPARE LIKE 'On-Track in Assessments, On-Track in ELA CG' AND PPPFINAL.EOY_LIT_ELA_POST_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in ELA CG' THEN 3 WHEN PPPFINAL.EOY_LIT_ELA_PRE_COMPARE LIKE 'On-Track in Assessments, On-Track in ELA CG' AND PPPFINAL.EOY_LIT_ELA_POST_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in ELA CG' THEN 2 ELSE NULL END AS EOY_LITON_ELAON_CHANGE_NUM,
CASE WHEN PPPFINAL.EOY_LIT_ELA_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in ELA CG' AND PPPFINAL.EOY_LIT_ELA_POST_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in ELA CG' THEN 'Remained Off-Track/Sliding in Assessments, Moved Off-Track/Sliding in ELA CG' WHEN PPPFINAL.EOY_LIT_ELA_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in ELA CG' AND PPPFINAL.EOY_LIT_ELA_POST_COMPARE LIKE 'On-Track in Assessments, On-Track in ELA CG' THEN 'Moved On-Track in Assessments and Remained On-Track in ELA CG' WHEN PPPFINAL.EOY_LIT_ELA_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in ELA CG' AND PPPFINAL.EOY_LIT_ELA_POST_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in ELA CG' THEN 'Remained Off-Track/Sliding in Assessments, Remained On-Track in ELA CG' WHEN PPPFINAL.EOY_LIT_ELA_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in ELA CG' AND PPPFINAL.EOY_LIT_ELA_POST_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in ELA CG' THEN 'Moved On-Track in Assessments, Moved Off-Track/Sliding in ELA CG' ELSE NULL END AS EOY_LITOFF_ELAON_CHANGE,
CASE WHEN PPPFINAL.EOY_LIT_ELA_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in ELA CG' AND PPPFINAL.EOY_LIT_ELA_POST_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in ELA CG' THEN 4 WHEN PPPFINAL.EOY_LIT_ELA_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in ELA CG' AND PPPFINAL.EOY_LIT_ELA_POST_COMPARE LIKE 'On-Track in Assessments, On-Track in ELA CG' THEN 1 WHEN PPPFINAL.EOY_LIT_ELA_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in ELA CG' AND PPPFINAL.EOY_LIT_ELA_POST_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in ELA CG' THEN 3 WHEN PPPFINAL.EOY_LIT_ELA_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in ELA CG' AND PPPFINAL.EOY_LIT_ELA_POST_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in ELA CG' THEN 2 ELSE NULL END AS EOY_LITOFF_ELAON_CHANGE_NUM,
CASE WHEN PPPFINAL.EOY_LIT_ELA_PRE_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in ELA CG' AND PPPFINAL.EOY_LIT_ELA_POST_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in ELA CG' THEN 'Moved Off-Track/Sliding in Assessments, Remained Off-Track/Sliding in ELA CG' WHEN PPPFINAL.EOY_LIT_ELA_PRE_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in ELA CG' AND PPPFINAL.EOY_LIT_ELA_POST_COMPARE LIKE 'On-Track in Assessments, On-Track in ELA CG' THEN 'Remained On-Track in Assessments, Moved On-Track in ELA CG' WHEN PPPFINAL.EOY_LIT_ELA_PRE_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in ELA CG' AND PPPFINAL.EOY_LIT_ELA_POST_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in ELA CG' THEN 'Moved Off-Track/Sliding in Assessments, Moved On-Track in ELA CG' WHEN PPPFINAL.EOY_LIT_ELA_PRE_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in ELA CG' AND PPPFINAL.EOY_LIT_ELA_POST_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in ELA CG' THEN 'Remained On-Track in Assessments, Remained Off-Track/Sliding in ELA CG' ELSE NULL END AS EOY_LITON_ELAOFF_CHANGE,
CASE WHEN PPPFINAL.EOY_LIT_ELA_PRE_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in ELA CG' AND PPPFINAL.EOY_LIT_ELA_POST_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in ELA CG' THEN 4 WHEN PPPFINAL.EOY_LIT_ELA_PRE_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in ELA CG' AND PPPFINAL.EOY_LIT_ELA_POST_COMPARE LIKE 'On-Track in Assessments, On-Track in ELA CG' THEN 1 WHEN PPPFINAL.EOY_LIT_ELA_PRE_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in ELA CG' AND PPPFINAL.EOY_LIT_ELA_POST_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in ELA CG' THEN 3 WHEN PPPFINAL.EOY_LIT_ELA_PRE_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in ELA CG' AND PPPFINAL.EOY_LIT_ELA_POST_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in ELA CG' THEN 2 ELSE NULL END AS EOY_LITON_ELAOFF_CHANGE_NUM
INTO ImpactAnalytics.dbo.FY14_EOY_LIT_ASSESS_ELA_CG
FROM
(*****ABOVE_QUERY*****)
AS PPPFINAL
ORDER BY SITE_NAME, SCHOOL_NAME, GRADE_ID, STUDENT_ID;

-- QUERY SYNTAX (SINGLE QUERY VERSION):

DROP TABLE ImpactAnalytics.dbo.FY14_EOY_LIT_ASSESS_ELA_CG
SELECT PPPFINAL.*,
CASE WHEN PPPFINAL.EOY_LIT_ELA_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in ELA CG' AND PPPFINAL.EOY_LIT_ELA_POST_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in ELA CG' THEN 'Remained Off-Track/Sliding in Assessments and ELA CG' WHEN PPPFINAL.EOY_LIT_ELA_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in ELA CG' AND PPPFINAL.EOY_LIT_ELA_POST_COMPARE LIKE 'On-Track in Assessments, On-Track in ELA CG' THEN 'Moved On-Track in Both Assessments and ELA CG' WHEN PPPFINAL.EOY_LIT_ELA_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in ELA CG' AND PPPFINAL.EOY_LIT_ELA_POST_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in ELA CG' THEN 'Remained Off-Track/Sliding in Assessments, Moved On-Track in ELA CG' WHEN PPPFINAL.EOY_LIT_ELA_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in ELA CG' AND PPPFINAL.EOY_LIT_ELA_POST_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in ELA CG' THEN 'Moved On-Track in Assessments, Remained Off-Track/Sliding in ELA CG' ELSE NULL END AS EOY_LITOFF_ELAOFF_CHANGE,
CASE WHEN PPPFINAL.EOY_LIT_ELA_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in ELA CG' AND PPPFINAL.EOY_LIT_ELA_POST_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in ELA CG' THEN 4 WHEN PPPFINAL.EOY_LIT_ELA_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in ELA CG' AND PPPFINAL.EOY_LIT_ELA_POST_COMPARE LIKE 'On-Track in Assessments, On-Track in ELA CG' THEN 1 WHEN PPPFINAL.EOY_LIT_ELA_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in ELA CG' AND PPPFINAL.EOY_LIT_ELA_POST_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in ELA CG' THEN 3 WHEN PPPFINAL.EOY_LIT_ELA_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in ELA CG' AND PPPFINAL.EOY_LIT_ELA_POST_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in ELA CG' THEN 2 ELSE NULL END AS EOY_LITOFF_ELAOFF_CHANGE_NUM,
CASE WHEN PPPFINAL.EOY_LIT_ELA_PRE_COMPARE LIKE 'On-Track in Assessments, On-Track in ELA CG' AND PPPFINAL.EOY_LIT_ELA_POST_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in ELA CG' THEN 'Moved Off-Track/Sliding in Both Assessments and ELA CG' WHEN PPPFINAL.EOY_LIT_ELA_PRE_COMPARE LIKE 'On-Track in Assessments, On-Track in ELA CG' AND PPPFINAL.EOY_LIT_ELA_POST_COMPARE LIKE 'On-Track in Assessments, On-Track in ELA CG' THEN 'Remained On-Track in Assessments and ELA CG' WHEN PPPFINAL.EOY_LIT_ELA_PRE_COMPARE LIKE 'On-Track in Assessments, On-Track in ELA CG' AND PPPFINAL.EOY_LIT_ELA_POST_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in ELA CG' THEN 'Moved Off-Track/Sliding in Assessments, Remained On-Track in ELA CG' WHEN PPPFINAL.EOY_LIT_ELA_PRE_COMPARE LIKE 'On-Track in Assessments, On-Track in ELA CG' AND PPPFINAL.EOY_LIT_ELA_POST_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in ELA CG' THEN 'Remained On-Track in Assessments, Moved Off-Track/Sliding in ELA CG' ELSE NULL END AS EOY_LITON_ELAON_CHANGE,
CASE WHEN PPPFINAL.EOY_LIT_ELA_PRE_COMPARE LIKE 'On-Track in Assessments, On-Track in ELA CG' AND PPPFINAL.EOY_LIT_ELA_POST_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in ELA CG' THEN 4 WHEN PPPFINAL.EOY_LIT_ELA_PRE_COMPARE LIKE 'On-Track in Assessments, On-Track in ELA CG' AND PPPFINAL.EOY_LIT_ELA_POST_COMPARE LIKE 'On-Track in Assessments, On-Track in ELA CG' THEN 1 WHEN PPPFINAL.EOY_LIT_ELA_PRE_COMPARE LIKE 'On-Track in Assessments, On-Track in ELA CG' AND PPPFINAL.EOY_LIT_ELA_POST_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in ELA CG' THEN 3 WHEN PPPFINAL.EOY_LIT_ELA_PRE_COMPARE LIKE 'On-Track in Assessments, On-Track in ELA CG' AND PPPFINAL.EOY_LIT_ELA_POST_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in ELA CG' THEN 2 ELSE NULL END AS EOY_LITON_ELAON_CHANGE_NUM,
CASE WHEN PPPFINAL.EOY_LIT_ELA_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in ELA CG' AND PPPFINAL.EOY_LIT_ELA_POST_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in ELA CG' THEN 'Remained Off-Track/Sliding in Assessments, Moved Off-Track/Sliding in ELA CG' WHEN PPPFINAL.EOY_LIT_ELA_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in ELA CG' AND PPPFINAL.EOY_LIT_ELA_POST_COMPARE LIKE 'On-Track in Assessments, On-Track in ELA CG' THEN 'Moved On-Track in Assessments and Remained On-Track in ELA CG' WHEN PPPFINAL.EOY_LIT_ELA_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in ELA CG' AND PPPFINAL.EOY_LIT_ELA_POST_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in ELA CG' THEN 'Remained Off-Track/Sliding in Assessments, Remained On-Track in ELA CG' WHEN PPPFINAL.EOY_LIT_ELA_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in ELA CG' AND PPPFINAL.EOY_LIT_ELA_POST_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in ELA CG' THEN 'Moved On-Track in Assessments, Moved Off-Track/Sliding in ELA CG' ELSE NULL END AS EOY_LITOFF_ELAON_CHANGE,
CASE WHEN PPPFINAL.EOY_LIT_ELA_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in ELA CG' AND PPPFINAL.EOY_LIT_ELA_POST_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in ELA CG' THEN 4 WHEN PPPFINAL.EOY_LIT_ELA_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in ELA CG' AND PPPFINAL.EOY_LIT_ELA_POST_COMPARE LIKE 'On-Track in Assessments, On-Track in ELA CG' THEN 1 WHEN PPPFINAL.EOY_LIT_ELA_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in ELA CG' AND PPPFINAL.EOY_LIT_ELA_POST_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in ELA CG' THEN 3 WHEN PPPFINAL.EOY_LIT_ELA_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in ELA CG' AND PPPFINAL.EOY_LIT_ELA_POST_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in ELA CG' THEN 2 ELSE NULL END AS EOY_LITOFF_ELAON_CHANGE_NUM,
CASE WHEN PPPFINAL.EOY_LIT_ELA_PRE_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in ELA CG' AND PPPFINAL.EOY_LIT_ELA_POST_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in ELA CG' THEN 'Moved Off-Track/Sliding in Assessments, Remained Off-Track/Sliding in ELA CG' WHEN PPPFINAL.EOY_LIT_ELA_PRE_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in ELA CG' AND PPPFINAL.EOY_LIT_ELA_POST_COMPARE LIKE 'On-Track in Assessments, On-Track in ELA CG' THEN 'Remained On-Track in Assessments, Moved On-Track in ELA CG' WHEN PPPFINAL.EOY_LIT_ELA_PRE_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in ELA CG' AND PPPFINAL.EOY_LIT_ELA_POST_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in ELA CG' THEN 'Moved Off-Track/Sliding in Assessments, Moved On-Track in ELA CG' WHEN PPPFINAL.EOY_LIT_ELA_PRE_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in ELA CG' AND PPPFINAL.EOY_LIT_ELA_POST_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in ELA CG' THEN 'Remained On-Track in Assessments, Remained Off-Track/Sliding in ELA CG' ELSE NULL END AS EOY_LITON_ELAOFF_CHANGE,
CASE WHEN PPPFINAL.EOY_LIT_ELA_PRE_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in ELA CG' AND PPPFINAL.EOY_LIT_ELA_POST_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in ELA CG' THEN 4 WHEN PPPFINAL.EOY_LIT_ELA_PRE_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in ELA CG' AND PPPFINAL.EOY_LIT_ELA_POST_COMPARE LIKE 'On-Track in Assessments, On-Track in ELA CG' THEN 1 WHEN PPPFINAL.EOY_LIT_ELA_PRE_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in ELA CG' AND PPPFINAL.EOY_LIT_ELA_POST_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in ELA CG' THEN 3 WHEN PPPFINAL.EOY_LIT_ELA_PRE_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in ELA CG' AND PPPFINAL.EOY_LIT_ELA_POST_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in ELA CG' THEN 2 ELSE NULL END AS EOY_LITON_ELAOFF_CHANGE_NUM
INTO ImpactAnalytics.dbo.FY14_EOY_LIT_ASSESS_ELA_CG
FROM
(SELECT prepost_LIT.SITE_NAME, prepost_LIT.SCHOOL_NAME, prepost_LIT.GRADE_ID, prepost_LIT.DIPLOMAS_NOW_SCHOOL, prepost_LIT.STUDENT_ID, prepost_LIT.SCHOOL_ID, prepost_LIT.ASSESSMENT_TYPE, prepost_LIT.PRE_VALUE, prepost_LIT.PRE_VALUE_DISPLAY, prepost_LIT.PRE_VALUE_NUM, prepost_LIT.PRE_DATE, prepost_LIT.PRE_DESC, prepost_LIT.PRE_TRACK, prepost_LIT.PRE_TRACK_EVAL, prepost_LIT.PRE_TRACK_NATIONAL, prepost_LIT.POST_VALUE, prepost_LIT.POST_VALUE_DISPLAY, prepost_LIT.POST_VALUE_NUM, prepost_LIT.POST_DATE, prepost_LIT.POST_DESC, prepost_LIT.POST_TRACK, prepost_LIT.POST_TRACK_EVAL, prepost_LIT.POST_TRACK_NATIONAL, prepost_LIT.DOSAGE_CATEGORY, prepost_LIT.TTL_TIME, prepost_LIT.ENROLLED_DAYS_CATEGORIES, prepost_LIT.CURRENTLY_ENROLLED, prepost_LIT.ENROLLED_DAYS, prepost_LIT.LIT_ASSESS_RAWCHANGE, prepost_LIT.LIT_ASSESS_RAWCHANGE_DEGREE, prepost_LIT.LIT_ASSESS_PERFORMANCECHANGE_LOCAL, prepost_LIT.LIT_ASSESS_PERFORMANCECHANGE_NORMALIZED, prepost_LIT.LIT_ASSESS_PERCENTCHANGE, prepost_LIT.STATUS_SITE_DOSAGE_GOAL, prepost_LIT.SITE_DOSAGE_GOAL, prepost_LIT.Attendance_IA, prepost_LIT.ELA_IA, prepost_LIT.Math_IA, prepost_LIT.Behavior_IA, prepost_LIT.INDICATOR_ID, prepost_LIT.B_RULE_VAL1, prepost_LIT.B_RULE_VAL2, prepost_LIT.B_RULE_VAL3, prepost_LIT.B_RULE_VAL4, prepost_LIT.B_RULE_VAL5, prepost_LIT.GRADE_ID_RECODE, prepost_LIT.EOY_MET_Q3_DOSAGE, prepost_LIT.DN_SCHOOL_BY_GRADE, prepost_LIT.EOY_IN_IOG_GRADE_RANGE, prepost_ELACG.PRE_ELA_CG_VALUE, prepost_ELACG.PRE_ELA_CG_VALUE_DISPLAY, prepost_ELACG.PRE_ELA_CG_VALUE_NUM, prepost_ELACG.PRE_ELA_DESC, prepost_ELACG.PRE_ELA_FREQ, prepost_ELACG.PRE_ELA_TRACK, prepost_ELACG.PRE_ELA_TRACK_EVAL, prepost_ELACG.PRE_SCENARIO, prepost_ELACG.PRE_LETTER_VIEW, prepost_ELACG.PRE_CG_LETTER_SCALE_ALL, prepost_ELACG.POST_ELA_CG_VALUE, prepost_ELACG.POST_ELA_CG_VALUE_DISPLAY, prepost_ELACG.POST_ELA_CG_VALUE_NUM, prepost_ELACG.POST_ELA_DESC, prepost_ELACG.POST_ELA_FREQ, prepost_ELACG.POST_ELA_TRACK, prepost_ELACG.POST_ELA_TRACK_EVAL, prepost_ELACG.POST_SCENARIO, prepost_ELACG.POST_LETTER_VIEW, prepost_ELACG.POST_CG_LETTER_SCALE_ALL, prepost_ELACG.LETTERGADE_CHANGE_ACTUAL, prepost_ELACG.LETTERGADE_CHANGE_GENERAL, prepost_ELACG.CG_Performance_Level_Change, prepost_ELACG.CG_Change, prepost_ELACG.Enrollment_Duration, prepost_ELACG.ENROLL_DAYS,
CASE WHEN (prepost_LIT.PRE_TRACK_EVAL LIKE 'OFF TRACK' OR prepost_LIT.PRE_TRACK_EVAL LIKE 'SLIDING') AND (prepost_ELACG.PRE_ELA_TRACK LIKE 'OFF TRACK' OR prepost_ELACG.PRE_ELA_TRACK LIKE 'SLIDING') THEN 'Off-Track/Sliding in Assessments, Off-Track/Sliding in ELA CG' WHEN (prepost_LIT.PRE_TRACK_EVAL LIKE 'OFF TRACK' OR prepost_LIT.PRE_TRACK_EVAL LIKE 'SLIDING') AND (prepost_ELACG.PRE_ELA_TRACK LIKE 'ON TRACK') THEN 'Off-Track/Sliding in Assessments, On-Track in ELA CG' WHEN (prepost_LIT.PRE_TRACK_EVAL LIKE 'ON TRACK') AND (prepost_ELACG.PRE_ELA_TRACK LIKE 'OFF TRACK' OR prepost_ELACG.PRE_ELA_TRACK LIKE 'SLIDING') THEN 'On-Track in Assessments, Off-Track/Sliding in ELA CG' WHEN (prepost_LIT.PRE_TRACK_EVAL LIKE 'ON TRACK') AND (prepost_ELACG.PRE_ELA_TRACK LIKE 'ON TRACK') THEN 'On-Track in Assessments, On-Track in ELA CG' ELSE NULL END AS EOY_LIT_ELA_PRE_COMPARE,
CASE WHEN (prepost_LIT.PRE_TRACK_EVAL LIKE 'OFF TRACK' OR prepost_LIT.PRE_TRACK_EVAL LIKE 'SLIDING') AND (prepost_ELACG.PRE_ELA_TRACK LIKE 'OFF TRACK' OR prepost_ELACG.PRE_ELA_TRACK LIKE 'SLIDING') THEN 4 WHEN (prepost_LIT.PRE_TRACK_EVAL LIKE 'OFF TRACK' OR prepost_LIT.PRE_TRACK_EVAL LIKE 'SLIDING') AND (prepost_ELACG.PRE_ELA_TRACK LIKE 'ON TRACK') THEN 3 WHEN (prepost_LIT.PRE_TRACK_EVAL LIKE 'ON TRACK') AND (prepost_ELACG.PRE_ELA_TRACK LIKE 'OFF TRACK' OR prepost_ELACG.PRE_ELA_TRACK LIKE 'SLIDING') THEN 2 WHEN (prepost_LIT.PRE_TRACK_EVAL LIKE 'ON TRACK') AND (prepost_ELACG.PRE_ELA_TRACK LIKE 'ON TRACK') THEN 1 ELSE NULL END AS EOY_LIT_ELA_PRE_COMPARE_NUM,
CASE WHEN (prepost_LIT.POST_TRACK_EVAL LIKE 'OFF TRACK' OR prepost_LIT.POST_TRACK_EVAL LIKE 'SLIDING') AND (prepost_ELACG.POST_ELA_TRACK LIKE 'OFF TRACK' OR prepost_ELACG.POST_ELA_TRACK LIKE 'SLIDING') THEN 'Off-Track/Sliding in Assessments, Off-Track/Sliding in ELA CG' WHEN (prepost_LIT.POST_TRACK_EVAL LIKE 'OFF TRACK' OR prepost_LIT.POST_TRACK_EVAL LIKE 'SLIDING') AND (prepost_ELACG.POST_ELA_TRACK LIKE 'ON TRACK') THEN 'Off-Track/Sliding in Assessments, On-Track in ELA CG' WHEN (prepost_LIT.POST_TRACK_EVAL LIKE 'ON TRACK') AND (prepost_ELACG.POST_ELA_TRACK LIKE 'OFF TRACK' OR prepost_ELACG.POST_ELA_TRACK LIKE 'SLIDING') THEN 'On-Track in Assessments, Off-Track/Sliding in ELA CG' WHEN (prepost_LIT.POST_TRACK_EVAL LIKE 'ON TRACK') AND (prepost_ELACG.POST_ELA_TRACK LIKE 'ON TRACK') THEN 'On-Track in Assessments, On-Track in ELA CG' ELSE NULL END AS EOY_LIT_ELA_POST_COMPARE,
CASE WHEN (prepost_LIT.POST_TRACK_EVAL LIKE 'OFF TRACK' OR prepost_LIT.POST_TRACK_EVAL LIKE 'SLIDING') AND (prepost_ELACG.POST_ELA_TRACK LIKE 'OFF TRACK' OR prepost_ELACG.POST_ELA_TRACK LIKE 'SLIDING') THEN 4 WHEN (prepost_LIT.POST_TRACK_EVAL LIKE 'OFF TRACK' OR prepost_LIT.POST_TRACK_EVAL LIKE 'SLIDING') AND (prepost_ELACG.POST_ELA_TRACK LIKE 'ON TRACK') THEN 3 WHEN (prepost_LIT.POST_TRACK_EVAL LIKE 'ON TRACK') AND (prepost_ELACG.POST_ELA_TRACK LIKE 'OFF TRACK' OR prepost_ELACG.POST_ELA_TRACK LIKE 'SLIDING') THEN 2 WHEN (prepost_LIT.POST_TRACK_EVAL LIKE 'ON TRACK') AND (prepost_ELACG.POST_ELA_TRACK LIKE 'ON TRACK') THEN 1 ELSE NULL END AS EOY_LIT_ELA_POST_COMPARE_NUM
FROM
FY14_EOY_LIT_ASSESS
AS prepost_LIT INNER JOIN
FY14_EOY_ELA_CG
AS prepost_ELACG
ON prepost_LIT.STUDENT_ID = prepost_ELACG.STUDENT_ID)
AS PPPFINAL
ORDER BY SITE_NAME, SCHOOL_NAME, GRADE_ID, STUDENT_ID;